#include "alg_mlp_network.h"

/* define the BP networks*/
#define NETWORKS_INPUT_SIZE (20) /* input data feature dimension */
#define NETWORKS_LINNER1_SIZE (24) /* hidden layer neuron number */
#define NETWORKS_BATCHNORMAL1D_SIZE (24)
#define NETWORKS_LINNER2_SIZE (22)
#define NETWORKS_POOL_SIZE (2)
#define NETWORKS_OUTPUT_SIZE (11) /* class number */

#define EPS 0.00001
#define FLT_MIN 1.175494351e-38F

#define NET_NORMAL 0
#define NET_ERR_GENERIC -1

/* weight: reshape the original [row_num, column_num] matrix into
 * [row_num*column_num, 1] along columns */
typedef struct NetwoksLayer {
    uint16_t row_num;
    uint16_t column_num;
    const float *weight;
    const float *bias;
} NetwoksLayer;

typedef struct BpNetworks {
    NetwoksLayer linner_layer1;
    NetwoksLayer linner_layer2;

} BpNetworks;

static BpNetworks bp_networks;

//* changed weight
const float linner_layer1_weight[NETWORKS_INPUT_SIZE * NETWORKS_LINNER1_SIZE] = {
    -0.4701206516861406,     -0.1597129991336361,   -0.9465172353339458,
    -0.2986641143785095,     -0.5605856398814778,   -0.17172748370457272,
    -0.13859343176504701,    -0.05410018398076244,  -0.11199049171390946,
    0.17270698661615827,     -0.148719096771961,    -0.04533943027970669,
    0.04798412661833309,     -0.2979920911235109,   -0.11047133146928231,
    0.39077259197627795,     0.5525844734155841,    0.2920207108666102,
    -0.10621862588121496,    0.015575607145557935,  0.4889157361943113,
    0.3293099079089706,      -0.020023466332044593, 0.4040242994797678,
    0.09844756861141782,     0.3856337906116112,    0.28894949537666237,
    -1.1360473407282354,     -0.2897968043383596,   0.14310537752920877,
    0.619381138386771,       0.5763176820266588,    0.3547799466001217,
    -0.30957646706756514,    -0.6683037046734314,   -0.6053285138902829,
    -0.1673516106563749,     0.04477477573392871,   0.13868325953227997,
    0.16616476138018035,     0.16847849652120708,   0.1286624162585395,
    -0.32702425622027587,    0.03457307995238133,   -0.12511023607030855,
    0.1626622411791951,      0.11883520378524084,   0.36943446280769826,
    -0.22890372700508954,    0.8026986678992205,    0.037186018809004004,
    -0.26804932745592874,    0.26616906791930517,   0.12655148668937932,
    0.2172290846527372,      -0.8186862684037861,   -0.21278291776351363,
    -0.12903320270557803,    -0.6606838734221621,   -0.585573505737252,
    0.1200912022446542,      0.24627352898467722,   0.15527358985808576,
    0.08793477925991329,     0.1064077063894892,    0.011090750189633288,
    0.0023787148450863044,   0.2375579616193363,    0.5794444656906276,
    -0.13198214481137718,    -0.6725451637267428,   -0.12350165736848061,
    -0.8742857895684107,     0.44177842414357443,   0.8593819243562435,
    0.42119424219323826,     0.11275862076346285,   -0.3108281560755573,
    0.27055439619505856,     0.19307943055141788,   -0.22900090361264705,
    0.45366405394466214,     -0.031041357688134777, -0.17250504821097648,
    0.1648033681856276,      0.13905529394273666,   -0.1701602719778614,
    0.30844912997292956,     -0.22898625797425307,  0.04612255955088818,
    -0.3346902256576277,     -0.5757221647773195,   0.17230562855867976,
    0.12913352618949583,     0.4606533143139708,    -0.18585006573774607,
    0.2575157494572748,      -0.06091969668794298,  -0.2733915263980989,
    -0.20616093121385334,    0.379249038512197,     0.2176815670710359,
    0.08776324507499965,     0.1972420927014515,    -0.11365870991742529,
    0.06089744586485919,     -0.1782585374045349,   -0.6681593541350046,
    0.13445616069137353,     0.05165118133081506,   -0.34060546589448737,
    0.1390823482711194,      -0.3345395248998477,   0.3881347021065144,
    0.5176517890986704,      -1.054321541646399,    -0.8969988859328907,
    0.008833422007711329,    -0.19153632178774352,  0.3501806769441474,
    0.18918439511723203,     0.3593099107706935,    -0.24087633782794496,
    0.2876200014138085,      -0.5670937138918252,   0.06820745737213697,
    -0.31584428201687764,    -0.03325604792511478,  0.3471117942287247,
    -0.7452062657115127,     -0.34653288712885744,  0.2204638349065306,
    0.06353166382866464,     0.16492220475327124,   0.9449590843111547,
    -0.17078302369628534,    0.3066284558193319,    -0.5378924502905567,
    -0.8070211876053682,     0.2661070344986758,    0.2597364380572823,
    0.3830978895631706,      0.38109387489055274,   -0.06687026662251827,
    0.046694726024599294,    -0.03189499506624973,  0.15081076588417874,
    0.35134396700150766,     -0.07926354486907355,  -0.4733683233081358,
    -0.7039583569132748,     -0.8274047504042125,   -0.4806525463128412,
    0.3518282514199231,      0.17353718850599953,   -0.4886017241562282,
    -0.1320846721358584,     -0.41374234719430925,  -0.1132405585530553,
    0.1137554194833871,      0.03126887214506095,   0.30676811343232413,
    -0.23152285432057013,    -0.5237736345633099,   0.09099909683470947,
    0.10790334876432373,     -0.13921839567020705,  -0.27904245795632454,
    -0.20621120310837318,    -0.10271349515909978,  0.7774054113509854,
    -0.784323167417265,      -0.058539444506010695, 0.4011555486814347,
    -1.2275630249800895,     -0.2817102467493034,   0.021391782173349416,
    0.04687648214085098,     0.7461524726845248,    0.09562871740461013,
    0.02840663107997666,     -0.39445505082619625,  0.37302852441311746,
    -0.1882023122515317,     0.46438473247245426,   0.12784655091799277,
    0.2535034290983784,      -0.19094268413902332,  -0.685274846195042,
    -0.019369970974732864,   0.09938220128638292,   0.5807078259075636,
    0.03477892195580459,     -0.4526410025287211,   -0.8780305032939743,
    0.037864351519582035,    0.08475491817053066,   -0.00835274166515773,
    -0.24496380725301814,    -0.7729423240820773,   0.16849776042444703,
    0.031169890260484816,    -0.3463415644742409,   0.1622686864413753,
    0.017559371293638194,    0.1019739738833814,    -0.04232973078723496,
    0.5933686889764771,      0.07600980114841463,   0.09649451284872668,
    0.025561094943830936,    -0.4678955521581241,   -0.2732274130111817,
    -0.11956700919157376,    0.19258307560664717,   -0.6093694139765377,
    -0.8432387149282281,     -0.19048626787900452,  0.10025836129418368,
    -0.22360376144794916,    0.5984730023919216,    0.3909772473367126,
    0.37894910776791646,     -0.13250242520486546,  -0.03610512812951897,
    0.26478002298554715,     -0.12294611053281852,  -0.3205506327329143,
    -0.23591709663776736,    -0.13048789020583573,  0.7654898453765716,
    0.7377917421211084,      0.33801115332110176,   0.2466889772079412,
    -0.7654443236016675,     -0.4725413167546271,   -0.007152887503275641,
    -0.17154049320979575,    0.22902595336056372,   0.20648384389382643,
    0.16086140126986304,     0.32765331896948313,   -0.28502940092729906,
    -0.032348270067727315,   0.2047653702780313,    -0.19063249352762687,
    -1.8786721993642097e-05, 0.1705663351888406,    0.007105980572591885,
    0.07416928840422735,     -0.6442754712050248,   -0.8416166695829288,
    0.09033111758249339,     -0.027947484751097276, 0.5696672718481176,
    0.03125128118435858,     -0.15396560188924227,  -0.04643430041782531,
    -0.17034110145415804,    -0.3789878452207787,   0.034522672144211106,
    0.12991252944253212,     0.4173066268934016,    0.3160464865181703,
    0.41837512146102324,     -0.17468938687130672,  0.024864406625138412,
    0.24643771193236752,     0.2880943553692581,    0.21605734054237277,
    -0.26793789104926063,    -0.5026170523849063,   -0.5311944858633697,
    0.5517355819485991,      0.16514942687672082,   -0.5745762268049969,
    -0.3226437819057541,     -0.160852665383821,    -0.051270638897278877,
    0.3420015573914104,      0.10007378880698782,   -0.20044213290843585,
    -0.17418617419262852,    0.3752652472992243,    0.09348785622193852,
    0.2560009446328378,      -0.09797065831806988,  0.2792115353531325,
    0.21448511498936051,     -0.08345752401953492,  -0.2155928486240598,
    -0.32929191821301734,    -0.28765040853493085,  0.38241266485295866,
    -0.13820382573648693,    -0.7791431438385027,   -0.8217302380787308,
    -0.0452339914785038,     0.0342598145976773,    0.02323155675708602,
    -0.6450476220103809,     -0.10826327758474559,  -0.6798147539653161,
    -0.11890054874571879,    -0.043723908381118046, -0.5185934271445322,
    -0.00024311326964550776, 0.23867188734195624,   0.4389625402419936,
    0.20274590675891002,     -0.4997783216095046,   -0.36752073346350966,
    0.109692259460561,       -0.04805884644265385,  -0.09986545925539839,
    0.40989606400777095,     0.23716800881097252,   0.10091062988055031,
    -0.05163518449393126,    0.570207003638323,     0.18581626439608515,
    0.22426680190500298,     -0.2664500815733207,   0.012448119627376004,
    0.3445403633843299,      0.2989863882277043,    0.1844797229684574,
    -0.5616803488345695,     0.3312236442300484,    -0.49197917564901883,
    -0.0537766380541876,     -0.5286451361429495,   0.06752611182023473,
    0.02846054480179573,     -0.8044858539389167,   -0.36482621984777247,
    -0.48800253965781326,    0.469214484198426,     0.283216583233414,
    0.34370763742327703,     0.18263765296292647,   -0.2880135473248815,
    0.690452294405283,       0.12891986591362023,   -0.04331718189913236,
    0.13556628729935624,     0.15580951893120992,   0.106304230164304,
    -0.2889456589325106,     0.11936520332027116,   0.08919827201811216,
    1.3326648458596217,      -0.09396450123980654,  0.16152962360218878,
    0.054017104698814176,    -0.14364013582581317,  0.19389328254216542,
    -0.03516386889039653,    -0.7787150701132439,   0.20836676673386872,
    -0.3142529847807684,     -0.7599629442488806,   -0.21734357793625086,
    0.785788092821252,       -0.18106715824022915,  0.25293568075663275,
    0.6612055617118103,      -0.32486150484921944,  -0.4493370339134435,
    0.11112248871123552,     -0.560014529923249,    -0.24343237631862114,
    -0.6268867853399801,     -0.17421082893866002,  -0.24272846793753006,
    0.3556588982089905,      0.13547181343689313,   0.18719830026196635,
    0.4899317461111211,      -0.21316605640778552,  0.6781102547881819,
    0.07769541207340068,     0.1425004881677351,    0.49582075232359635,
    0.23987917408545642,     0.5746982825195106,    0.4455403386499043,
    -0.4470268932896173,     -0.3050424755478569,   -0.2203198871877296,
    0.791356715315968,       0.34316715341575116,   0.6011676833544691,
    -0.26454396746955555,    -0.6429523879684973,   -0.2140351706095375,
    0.4160169986834557,      -0.34752843042948234,  -0.13426129858557295,
    0.4670031989922917,      0.6540827952464306,    0.21889930443509323,
    -0.02415645279092913,    0.4559209524597505,    0.3767526256775042,
    0.06894147937792862,     0.5597370982145031,    -0.5856594524011843,
    -0.48037633920870715,    -0.0870121486766149,   0.8556457515119384,
    0.2836591560131303,      0.8375008464187507,    0.15012485694894365,
    -0.7488360231982863,     -0.2088201988677949,   0.15344445276745539,
    -0.2896980461414131,     0.1632040698531167,    0.3157803190968099,
    0.18493545329638006,     0.06813717519925555,   0.06968905184360175,
    0.3157110880331963,      0.2314537324382664,    0.017996907978680744,
    0.03469099428275763,     0.4870476472428029,    -0.2837175534114688,
    0.27834478603592144,     -0.31301370575981385,  -0.3598101955673356,
    0.034088418971311395,    0.41750645438154355,   0.017912226299599304,
    -0.47542283029469384,    -0.07802776281712577,  -0.4951773380904862,
    0.032089459601844374,    0.03565957648633736,   -0.30229385287163174,
    -0.08556909354456944,    -0.3337072278725318,   0.13586274946561405,
    -0.4287783333783108,     0.184166582739921,     -0.16462541862987254,
    0.40391529902168444,     -0.11081347863617713,  0.2147356131667195,
    0.06149076485793039,     0.5608329710030155,    0.4242042426878511,
    0.011487423632785867,    0.03666340678363423,   1.0566169591330516,
    -0.34858160132647364,    0.4164274076561663,    -0.7847303324489564,
    0.03283010752296156,     -0.1886198375395057,   -0.14891691693146508,
    -0.2474940799955809,     0.34205369689531834,   -0.27800831979544893,
    0.3528005803612382,      -0.044121767506746,    -0.4756770128661741,
    -0.19943027611187727,    0.18803079893461908,   -0.29654157199928044,
    -0.026447677645805995,   0.3275540427570085,    0.06537343814528727,
    0.5361072903579992,      -0.7607400404594065,   -0.23734744334433833,
    -0.10108004340857968,    -0.8533351216434297,   -0.7016660583024568,
    0.10976139528293731,     -0.16366610180061597,  0.14030325709272096,
    0.7844652840218689,      -0.18718408180436777,  0.3724051859511593,
    0.271073601774483,       0.7015353697052767,    0.4397743609798008,
    -0.10758173326464514,    0.17482938966582964,   0.5544333823595922,
    -0.055569135556479944,   -0.10277232688915874,  0.8420194264282335,
    -0.19043553130332389,    -0.4619406227574417,   -0.18397931369378062,
    0.025105586089893314,    0.33553760956323314,   0.06740427639153215,
    0.09153266380927319,     0.06856955279038973,   0.47497845957183743,
    0.4327898419401973,      0.11935117965858573,   0.30483492256418365,
    -0.024596196040441366,   -0.22900765990262537,  0.4973260080304194,
    -0.1335760469434577,     -0.013588967550280289, 0.117660556076545,
    -1.0186567210072957,     -0.10511647011128289,  -0.3734384234285754,
    -0.8167686539118615,     -0.11365300874943275,  -0.05641918392572459,
    -0.7149623265490693,     -0.3599817769464455,   -0.1568649934364777,
    -0.5827493274948355,     -0.21405966559798656,  -0.4611058116279108,
    -0.18251542019755193,    0.18761610354303176,   -0.1508922479929871,
    0.09370973052287858,     0.11096766982259945,   0.161593237377212,
    0.021028990438602273,    0.17668582356498835,   -1.0321910032040962,
    -0.1870055941983633,     0.1211345135563567,    0.5422985059557429,
    -0.14600973297265762,    -0.05974506822730472,  -0.1203363142108948,
    0.024640062965319683,    0.11609564946547946,   -0.015130517968592305,
    -0.04960523340036893,    0.31898246302738803,   0.467143576937044,
    0.03702086722097806,     0.21033720962125996,   0.16252381816761471,
    0.3013811464384008,      -0.06524216024593817,  -0.8161568596261752,
    0.016439758618273237,    0.1843260197255709,    -0.498543315095263,
    -0.5349299226438313,     -0.5909982744335849,   0.06357181158021138,
    -0.0034121582865002617,  0.3594757266328709,    0.03700278478828042,
    -0.19662052342111538,    0.18289538358076946,   0.8851452893588082,
    -0.1115900105563169,     0.5454097093721363,    0.19035638219769027,
    0.6390521219986418,      0.4468440034521179,    0.622216842798309,
    0.36126081157195605,     0.5203479848042349,    -0.20061668062231536,
    -0.6320416317653325,     0.6439158978374057,    -0.24824834783709365,
    -0.46707300350417974,    -0.08438316783069554,  0.11617789143880607,
    0.004867643187178772,    -0.5755783973615958,   -0.6556413607921795,
    -0.2495641328459271,     0.29590106586279996,   -0.23571054673705794,
    -0.23396843727480532,    0.5202034787588734,    -0.03946541279912666,
    0.14963380895775288,     0.3079562264331423,    -0.272187267191478,
    -0.6591431668216013,     -0.4641453503294023,   0.5131254965170959,
    -0.26853620126782035,    0.3179658146503821,    -0.03591950852596352,
    0.21554519425060917,     0.3501394260006625,    0.5570913312176452,
    -0.20606992710349012,    -0.7207693908510591,   0.20075893288178864,
    0.8154619544681195,      -0.2853098944514443,   -0.40404976496030237,
    0.5983213172969583,      0.01728049104678218,   -0.19841297217462717,
    -0.13435532649384982,    -0.2656638365494657,   -1.3006949872001092,
    0.15254980096810727,     0.2829070363932361,    -0.15463111008579114,
    -0.03876928631752426,    0.09839350431450951,   -0.153141318583072,
    0.6042935432007555,      0.18560396493975867,   -0.044858468737545946,
    0.41799395810985296,     0.06296542678195292,   -0.37049750117725117,
    0.09358708651497526,     0.05562042660499525,   0.27170183977744167,
    0.009541222276095343,    -0.5768088680689607,   0.45946772508394507,
    -0.27360768580181727,    -0.3873652534263689,   -0.048650033098184914,
    0.08795314483845688,     0.5615422526972893,    0.08678716724625057,
    -0.04285028900030934,    -0.4718807954690801,   -0.10980314521113034,
    0.2008152281375906,      0.14535610146225092,   0.001521117832193993,
    -0.05106414033765357,    0.4096963882058514,    0.31165018729263644,
    0.607755557167917,       0.25787971013645217,   -0.23286124449713663,
    -0.1508948767095451,     0.43618835252675653,   0.14830114186240065,
    -0.3600330053411611,     0.2432465245811523,    -0.8647719399711999,
    -0.591408216950955,      -0.5764798377718247,   -0.42898346928457065,
    0.09556604068858487,     -0.24453435063504178,  -0.4439341519393774,
    0.054744272714806336,    0.10770140010130717,   0.2638823573894945,
    -0.24216619351207408,    0.2856464035971554,    0.31381633245470203,
    0.190380045486011,       0.33732031941988583,   -0.12724029821468244,
    0.07875660128352152,     -0.911684154024852,    -0.2788812046791165,
    -0.4666266036279737,     -0.4165021698814063,   0.4874444489755683,
    0.5188668675786106,      -0.38812567711730517,  -0.5137925864079921,
    0.15880826375403653,     -0.48098786054689197,  0.3544466104864729,
    -0.0437780890823899,     0.32564261977088504,   0.10638041430534752,
    0.23514382049429025,     0.11565691785454563,   0.17157835594325466,
    -0.1818229305235452,     0.14104254099806343,   0.1658908363033961,
    0.7397899584186959,      0.18367090830059335,   0.29783165169122094,
    0.7671951356244973,      -0.11125352129108777,  -0.5779501352063697,
    0.7315947518632283,      -0.38312791995004974,  0.027080636652738608,
    -0.017421840271744763,   -0.025109419946499508, -0.027203763449835387,
    -0.022924394046163976,   0.2899439474231095,    -0.10737532476824381,
    -0.08219628188080805,    -0.04299354568175168,  0.31817928704715265,
    -0.010216128559034999,   -0.11733613708425329,  -0.04234376096093254,
    -0.24953441666049148,    -0.3534997808346453,   0.08592630985902473,
    0.5469598967153547,      -0.773250188273853,    -0.49852047268532307,
    0.06175011376655706,     -0.08263481847280339,  0.3643206823589595,
    0.3611571631268091,      -0.3265112469442991,   0.15452698566518755,
    -0.03649235862737825,    0.2391705746824228,    0.1722625482046366,
    0.5742531323000732,      -0.37922843541080337,  -0.4933533226641147,
    -0.4667224614924974,     -0.27653927629029573,  0.44125490661794065,
    0.17435295755787408,     -0.8750079298206169,   -0.4267070820556918,
    0.3898877420435559,      -0.05682685635024566,  -0.16652719219530168,
    -0.0662002675327722,     -1.2578332646729784,   -0.06071321506891009,
    0.23858348223023018,     0.5291413846736678,    0.06075901418621936,
    0.17174007264642072,     0.31377308594579933,   0.4444138643810045,
    -0.3037707293313797,     0.26132741872626275,   -0.35371853155335514,
    -0.6976476879716346,     -0.19880181908156005,  -0.21011787783838157,
    0.4275647479622543,      0.512003600960495,     0.33003388801281364,
    0.36576613543344577,     -0.3394601941639792,   0.03266213887094012,
    -0.4295038909338101,     0.1260621203495654,    0.3075903713168067,
    -0.14919654259095236,    0.2542825973600609,    0.32682566021437204,
    -0.03610874299669336,    -0.1828795959573424,   0.9783336875049117,
    -0.1390162751926756,     0.13980581049310056,   -0.24731582366731222,
    -0.699071882940351,      0.1212691186803815,    0.3742918395997659,
    0.5462746971143179,      -0.4930192098454716,   0.293480374418035,
    -0.157868052685805,      -0.09106318697918576,  -0.253325353066665,
    -0.3377031348626862,     0.3433075112902212,    -0.17210686222639415,
    -0.14039914388371785,    0.029406150691525735,  -0.11437812456435553,
    -0.00322527603269853,    -0.19145498785100823,  0.24762320856925943,
    0.0626704273454125,      -0.43663538325799683,  -0.6069063525669663,
    0.33639551811220786,     0.017769953691743903,  0.4578023287613766,
    8.804202618316377e-05,   0.05241464974087295,   -0.2210027825376881,
    -0.13640251910191822,    -0.5552896499550973,   0.40781752466874993,
    -0.11286488582712152,    0.035261452547559455,  0.029116522090944855,
    0.20170872632529943,     0.6081063544922972,    0.3539346145523998,
    -0.23414436349819895,    0.024306117768179637,  -0.06071577483446286,
    -0.005522006447532906,   -0.012170551100910157, 0.4159470440645294,
    -1.1729931902640602,     -0.6790667460624557,   -0.3554199549776358,
    -0.5277409427571471,     -0.008467296275587594, -0.0614326471038325,
    -0.29101821177441706,    0.3452289763547937,    -0.017537686272825093,
    0.2783044288986938,      -0.0936706049833357,   0.19434411774647806,
    0.039472406142308944,    0.22439099863707743,   -0.17746343951748364,
    -0.20942702725981563,    0.01861688052658396,   -0.1783175404502152,
    -0.0027439057347360125,  -0.2550938029502378,   -0.5710834947918152,
    -0.03944327427263255,    0.38524125982632984,   -0.5472413565061118,
    -0.6006537762461259,     -0.18539889920142014,  -0.7220730179624096,
    0.2735399231445108,      -0.026847183335464538, 0.006256349572482426,
    0.5836077136959833,      0.18657155731785244,   0.24812199344629504,
    0.24800526142633555,     0.1520087458561452,    -0.10021908520517533,
    0.7039931921069131,      0.38187368152184764,   -0.03883126399136871,
    -0.16200024969082877,    -0.18741720418628022,  0.08799632633815059,
    -0.9208842096037319,     -0.5058399250833615,   0.040508138605178934,
    0.4590516720046715,      -0.14587682005012556,  0.3933031921443847,
    0.3939398078422018,      0.3541543540101552,    -0.2504414186242132,
    0.4412844977166593,      -0.0830460445475913,   0.20233936110199552,
    -0.3328231584950295,     -0.31704455262940584,  -0.09331436237902667,
    -0.4036531495085804,     -0.08122824592621647,  -0.07134053730475312,
    -0.6147146135696919,     -0.06599180156121957,  0.22877688410057248,
    0.005804725562920314,    -0.09265401802386355,  -0.16013587135971877,
    -0.6059406031010542,     -0.1114582460431068,   -0.26363625954139597,
    0.05939939916348546,     0.37285731037666336,   0.05899950878282339,
    0.00627895761790617,     0.26108104013702743,   0.5221489509100667,
    0.06894460904813604,     0.5095864592559217,    -0.15471225307155703,
    0.49975450712746505,     0.15009249623618018,   0.8058938333687741,
    0.14149273461154843,     0.41989889389336055,   -0.329311611553131,
    0.22564671864134253,     -0.42105587207630807,  0.5067262938377902,
    0.8272569549181752,      0.27302858311380357,   0.34122763321029836,
    0.20499883351896964,     0.1895718592285505,    0.12196228873360479,
    -0.0546978336415084,     -0.4780518028168348,   -0.21898516513512378,
    -0.16560851764283063,    0.9936062430749601,    0.6332856895566543,
    0.4865943059809599,      0.17136581339997525,   -0.4076945106259683,
    -0.28415533740438925,    -0.2816081634738825,   -0.08351005008885098,
    0.4409336368484119,      0.3498394174584314,    0.10146062652515597,
    -0.33659575960607796,    0.1237378945995527,    0.3593411272151802,
    0.03230986917362845,     -0.15425562807287532,  0.2293163442557045,
    0.46555820521226426,     0.18046590099632093,   -0.383505729452817,
    -0.11355924145355856,    -0.4198317395618315,   -0.9251433186024319,
    0.48848871532062627,     0.2956787376565915,    0.353030628659371,
    -0.059439889299813274,   -0.24372185131989443,  0.40055165480257987,
    0.2774415367206345,      -0.16667522190038891,  -0.24055532479135805,
    -0.5421797951812704,     0.03506414611263307,   -0.3244750533070859,
    -0.02227248602279039,    -0.1581026816577983,   -0.6516532165466828,
    0.224356144686472,       -0.2013783838783911,   -0.17769189929677376,
    -0.08886879529798411,    0.10152878366593975,   -1.0090458188703186,
    0.22585050251239444,     0.15994158823299132,   0.8063902542269217,
    -0.24510972043774912,    0.2658645014062956,    -0.3289633058882905,
    -0.28929691736625734,    0.24873112230448174,   0.16709526206050346,
    -0.8014787747698283,     -0.07081716574581981,  -0.22060155892193853,
    0.01386991930914505,     -0.05730575770970263,  -0.11256406554067373,
    0.286052362602116,       0.28824489871907677,   0.17512683738570806,
    0.4970068281343124,      -0.016331451661528166, -0.5275272491346902,
    0.22916573362346165,     0.0025966638638104853, 0.16084122544266033,
    -0.17435547176644103,    -0.3927550904043538,   -0.3180719162863128,
    -0.5510250059294853,     0.24601129650697592,   -0.559162320765448,
    0.24986666641581362,     -0.5523777400252697,   -0.06813344051779328,
    -0.15684361591968946,    -0.24009345260650644,  0.040366541103907486,
    0.28843642957877424,     0.8178888074984378,    0.5298294702907571,
    -0.6385589903174358,     0.08875158169076205,   0.16830432777252607,
    0.28371310337203515,     -0.12122216507244198,  0.3092479736444246,
    -0.14786528429890994,    -0.5055805879289866,   -0.47010437890777773,
    -0.5242293075881688,     -0.5131286417485148,   -0.4559517798143994,
    -0.181587668814499,      -0.39048518453893005,  -0.1657712548786127,
    -0.22930393602181987,    0.22657451500010362,   -0.1479516935172191,
    0.17701812344757073,     0.25979414679974894,   -0.4698125091205575,
    -0.18714570390780008,    0.7178959523600477,    0.6503636304966471,
    0.07205248113244807,     -0.1108867139387616,   -0.07637302703008722,
    0.21760533820565756,     -0.28092232451126226,  0.08306580476479739,
    0.37442742018719244,     -0.039194804598800655, -0.13953305726648826,
    -0.10670430794281645,    -0.059995393062265666, 0.11920386534954062,
    0.8029184262388717,      0.24131757552875552,   -0.08840624273776937,
    -0.15712701247836755,    0.1994326942508519,    0.3203250969616542,
    -0.748609420682922,      -0.11287183609869757,  0.07990862939667052,
    -0.2771764139988031,     0.2781480625858616,    0.1772131216805318,
    0.7172612356489462,      0.18480056996768465,   -0.3814515255213121,
    0.40875600170605575,     0.11997494073473434,   0.28453054306283876,
    -0.13996753635312256,    -0.6844041423715943,   -0.17060847408374805,
    -0.602204513026822,      -0.19860441357604014,  0.3521731337811361,
    0.004631657926069532,    -0.036568259037612356, 0.38556547243868483,
    0.13783232748901939,     0.26273775708250274,   0.2145307923796761,
    0.005835610076832358,    0.024856680990805933,  0.09871620444972852,
    0.01804092721030457,     0.46893351857568905,   0.029350894548428964,
    -0.200754301034443,      0.06200502198785858,   -0.3760017186545035,
    0.30961154861982276,     0.1744020513143325,    0.00748887173375548,
    -0.34402125544147505,    -0.221968472931416,    0.24459910905584553,
    0.3269554156888195,      -0.7885025665520362,   -1.2500353869287388,
    -0.0564003326449927,     -0.16196031238563516,  0.14436258176046823,
    0.09138524492243001,     -0.1907849510261342,   0.16690147910825937,
    -0.0639261844081293,     0.09035438825145733,   0.15186481567545185,
    0.14040771112609332,     -0.09069159391409702,  -0.18668808382727792,
    -0.24070513955414,       -0.41871400111255724,  0.14681156839989762,
    -0.5428003330448682,     0.03800993752190822,   -0.11568327868054636,
    0.04698169008467437,     -0.9488355088186631,   -0.9219793594151301,
    0.09149711606616659,     -0.23247890041268068,  0.06278154908901092,
    -0.09666114364646235,    -0.057774478987847926, 0.56633933817432,
    -0.2686725451170291,     0.21452808735662113,   -0.20171823989923102,
    0.05886115180748033,     -0.3923272022983409,   0.5189038436081058,
    -0.2067939072630299,     -0.6932429234791029,   0.440356238889387,
    0.40342207872200236,     0.20310411666080705,   -0.6804032020877583,
    0.0742669086534473,      -0.19062258501979962,  -0.38204684146186374,
    -0.06163337934916246,    -0.05829436043041568,  -0.29732345461851095,
    0.12547509105970103,     0.28222990843999174,   -0.3209449819853731,
    0.179808757737256,       -0.1165150762653911,   0.259144018510809,
    0.17412241728181432,     -0.5159467391667296,   -0.3661235378689984,
    -0.133625189858831,      0.22654656464719655,   0.5904362688884368,
    0.27568739490198774,     -0.6324737244105447,   0.10177261825904409,
    -0.09126277354522598,    0.09028869509337241,   0.23597013601216119,
    0.03546292541275433,     0.20889052436102676,   -0.12276178419815585,
    -0.23188924837018032,    0.22783557210928,      -0.35575062281537256,
    -0.1129303525611184,     0.028681612812330476,  0.3068111345043132,
    -0.5039943148200884,     -0.574921646255216,    -0.6739893861834723,
    -0.6990536672363759,     0.1778393041621615,    0.8193896429523209,
    0.1336830050134516,      -0.20203201522381337,  -0.19339917466188405,
    -0.2862088361339414,     0.204942263221391,     -0.04994733915670443,
    0.2606481344103277,      -0.19255174675575054,  0.28625054212171414,
    0.2276398997250008,      -0.03691283767467711,  0.07732273056387773,
    0.14317959436249766,     0.03013554786635417,   -0.23125104973379537,
    -0.789477239071844,      -0.5647918927298486,   -0.42206046395386104,
    -0.05289959148621104,    0.5104696773114441,    0.23718508635523025,
    0.04427447477333327,     -0.12619809461073658,  0.04964293853475767,
    -0.12640310731801202,    -0.3106565461314534,   -0.28664000932200534,
    0.2370807978903095,      -0.9303617067800718,   -0.5173011805103688,
    -0.7222888542947546,     -0.8788306186208928,   0.7842239480184728,
    0.18323330246742084,     -0.22809923844901883,  0.3247983148940314,
    0.6121997090014478,      -0.11648234877712549,  0.624118309287795,
    -0.2131660407053707,     -0.028361208505109155, -0.22693540864098102,
    0.4375686034615746,      0.22156720270415473,   0.11415546581624021,
    0.36332273421299877,     0.32620870006878455,   0.4829783098938305,
    -0.6600059704034302,     -0.05756381477700465,  0.14935359889413807,
    -0.11530207549529924,    0.12538982105214722,   -0.18061159608870062,
    -0.3136514048824034,     0.39080927024185524,   0.2160329600060047,
    -0.0779997717756266,     -0.4818662592063585,   -1.268666682574434,
    -0.41981366602444126,    -0.10610522413551474,  0.3512761964044609,
    0.09015063450459347,     -0.20395676666322504,  0.18788780073183553,
    -0.07857804753352052,    0.01825935058648503,   0.29364402254035993,
    -0.10190244425559356,    0.11153554842278984,   -0.2618765348760613,
    0.17841273703783794,     0.6326829080024137,    -0.5380157694866085,
    0.07175074123215883,     0.054182186031152095,  -0.29387008159776895,
    0.3138372455343741,      0.5690955397384331,    -0.7748139018357227,
    -0.8642004196904626,     0.42555858775741257,   0.010736294683077366,
    -0.0036462278864453274,  -0.4061890772281154,   0.04841204377030544,
    0.051884259689414035,    -0.5605793802475786,   -0.47991387082757797,
    -0.45295518362285175,    -0.5316282731968784,   -0.0930860137657971,
    0.22735414572460783,     0.11027040936714902,   0.4176778647723758,
    0.5656616979162331,      0.4897329542393215,    -0.6479696201606621,
    -0.13356239393560493,    0.10619692521553689,   0.4090696133508798,
    -0.0612305093677751,     0.5437309598972713,    0.1256848146562398,
    -0.16049900149574156,    -0.2590331585985726,   0.24964176911783034,
    0.28816085620736426,     0.014919992563459081,  0.24025770336843175,
    0.054967249778684564,    0.703971399415227,     0.3271191421744042,
    0.5126739502314549,      0.2893803961062098,    -0.04033946670612512,
    -0.21705373966575683,    0.38036854550984656,   0.15481885945778534,
    -0.8003236504343473,     0.6333153529369995,    -0.1385077870165021,
    -0.0803213446265476,     -0.02309198024310538,
};

const float linner_layer1_bias[NETWORKS_LINNER1_SIZE] = {
    -0.0976, -0.1643, -0.0021, 0.2406,  0.0322,  -0.0725, 0.1546,  0.2485,
    -0.2444, 0.2729,  0.0418,  0.1678,  -0.0827, 0.0203,  -0.2873, 0.2571,
    -0.1875, 0.1475,  0.3471,  -0.2206, -0.1344, -0.1288, 0.1899,  0.0094,
    0.2416,  0.1268,  -0.1274, -0.0823, -0.0142, 0.1866,  0.3207,  0.2039,
    -0.0089, 0.0284,  0.0842,  0.1216,  -0.0437, 0.0388,  0.2372,  0.2150,
    -0.0287, 0.0161,  -0.1975, 0.1902,  -0.1642, 0.1555,  -0.0682, 0.0026,
    0.0780,  0.1211,  0.1490,  0.0252,  0.5163,  -0.1283, -0.1262, -0.1616,
    0.0762,  -0.0342, 0.0887,  0.2401,  -0.2741, 0.0837,  0.3137,  -0.0118
};

const float
    linner_layer2_weight[NETWORKS_LINNER1_SIZE * NETWORKS_LINNER2_SIZE] = {
        -1.651333365550018,    0.3840354417888676,     -0.46855537409088477,
        -0.5251487558662887,   0.007429758880894567,   -0.5472443968475337,
        -0.965312503352814,    -0.20050175289722683,   0.8099388181479453,
        0.5809836125645971,    -0.5623267395862197,    0.15667229603337926,
        -0.4547918097195977,   -0.402211382688485,     -0.2391703291049374,
        -1.1260151894463446,   0.4966242743257512,     0.19047307047313744,
        -0.9609705895046048,   0.2797285456552147,     0.4791173877128611,
        -0.13316208482094227,  -0.1558306671302771,    -1.1712778236187817,
        -0.1937439790129995,   0.3108441086009482,     -0.9518575241702605,
        0.3082936480174414,    -0.31823503855967333,   -1.6282844949232755,
        -1.7651977630880584,   -0.012035214353041354,  0.44995411302780547,
        -0.1410505280861001,   0.1473881127564946,     -0.8135252115066363,
        0.4542040926346171,    -0.1218025205543037,    -0.33298478896382294,
        -0.3015240165722865,   0.7448495192939087,     0.13612859143854925,
        0.18613775723219175,   -0.0029934220466152775, 0.15640780009442581,
        0.2868029859589875,    -0.34946313837441834,   -0.6137837841036723,
        0.33235759065981424,   0.7605200311860586,     -0.3515363988490631,
        -0.5657188896700269,   0.1266478455191579,     -0.519052322381738,
        -0.040894569670064364, -0.9695900707783444,    -0.7805815447451794,
        -0.9602243535939906,   -0.400382703593583,     0.6959346045167407,
        0.7045761283799447,    -0.533043494024718,     0.4290596617548939,
        -0.29538537659553715,  -0.4497691230739901,    -0.19862642132396738,
        -0.1679368894612697,   -0.4041212739664669,    -0.254599987362875,
        -0.3058038456126958,   -0.2090864385775158,    -0.38903633761973866,
        -0.16675902149486238,  -0.29809696593878054,   -0.290745394425626,
        -0.1316479319068422,   -0.28333756045487996,   -0.4083504508835332,
        -0.3455744137611305,   -0.6152308039796467,    -0.3412531009869123,
        -0.17675118920144284,  -0.37230793179484306,   -0.07952157309838401,
        -0.1432677962401779,   -0.3515712786980416,    -0.534146197769513,
        -0.36037363670989175,  -0.14662945120896997,   -0.16671863180905752,
        -0.4273249816322661,   -0.22433267474784957,   -0.19306511727170125,
        -0.6665003422793077,   -0.5475339460250811,    -0.15112602127049188,
        -0.17307398252524145,  -0.1298728440983192,    -0.24590439791133253,
        -0.4912592537545915,   -0.15725313389098397,   -0.24005455778147253,
        -0.31635778723645513,  -0.36965269601084566,   -0.15556092253660417,
        -0.2869914173321656,   -0.040368330006338715,  -0.02414548593984762,
        -0.23782159843740594,  -0.17119101635150646,   -0.24927826855934593,
        -0.4877192850942823,   -0.36555049795513833,   -0.21795174313333923,
        -0.6016965250143648,   -0.1633169058617268,    -0.28644654457023705,
        -0.3444160767476689,   -0.278667751534305,     -0.4417275882864609,
        -0.38657562000140794,  -0.569963012371671,     -0.2576689771846927,
        -0.46473988089620716,  0.07143273698921569,    -0.2523250056389569,
        -0.36554169103417683,  -0.27370583902950496,   -0.39841302164470327,
        -0.003489780248073189, -0.2772997799744984,    -0.36302788264500174,
        -0.47392504987398715,  -0.46106930590990836,   -0.21726726485189232,
        -0.4242211206761954,   -0.11922862377656909,   -0.1796334349643464,
        -0.2457311119715715,   -0.1903438345018367,    -0.17802963981902686,
        -0.24989134893253576,  -0.29625370433146503,   -0.7001686470384434,
        -0.17607340092711776,  -0.23592135521100185,   -0.4587532088151864,
        -0.154594295889178,    -0.08167025081067267,   -0.36337913249050924,
        -0.4172825727798463,   -0.32140527383316153,   -0.2596997841250086,
        -0.257953697535577,    -0.3657187673058267,    -0.28592594526569687,
        -0.10195372573473659,  -0.7086254441798475,    -0.4935539077805198,
        -0.32793894233383575,  -0.2610005791892301,    -0.2434745668420362,
        -0.23942336945270257,  -0.3551793727614077,    -0.1404796448248066,
        -0.11066065900345173,  -0.28105601197578,      -0.4341326792479906,
        -0.26160342913366585,  -0.294036276515034,     -0.16785533695563487,
        -0.19742470876301238,  -0.3190217878485364,    -0.09099498327881787,
        -0.24652081155092007,  -0.49507756248652524,   -0.2808490829449958,
        -0.23070776177073152,  -0.5801600612490796,    -0.2503577558884109,
        -0.20634294253588642,  -0.22450459265937775,   -0.360186640793886,
        -0.3852027874660318,   -0.4009008661614219,    -0.5326958452223217,
        -0.23586835050709118,  -0.5645099712682067,    0.014664519209607253,
        -0.20244338716580249,  -0.41255895204301635,   -0.3909337504144692,
        -0.538900160217833,    -0.029906602533034548,  -0.15509018135599498,
        -0.3447325727728543,   -0.2047801473447035,    -0.4599371939264907,
        -0.27148930592942244,  -0.29436834162744574,   -0.1565210913162351,
        -0.11698067178127594,  -0.21935908067350726,   -0.16519922415858465,
        -0.35292412446279253,  -0.3204692976834594,    -0.39848366079592873,
        -0.5611809440154515,   -0.1645315640588157,    -0.11697676155113788,
        -0.496907284884461,    -0.0692215911091821,    -0.13140389047483655,
        -0.3782765895436252,   -0.48087579402734465,   -0.43953517932877845,
        -0.18473224923777132,  -0.09379430749358168,   -0.45579991129299624,
        -0.38708057939315904,  -0.07024267664662523,   -0.6410691703353145,
        -0.5266951296080129,   -0.355206019065258,     -0.2287167708580459,
        -0.11704407784758807,  -0.32609730007637816,   -0.4463135004212356,
        -0.11636536782757309,  -0.3151414377913269,    -0.3571974071947602,
        -0.41489843663927184,  -0.1077810479760888,    -0.3154666232672816,
        -0.0664041990294375,   -0.15578710441752697,   -0.2502528956018611,
        -0.06977361236374362,  -0.4355615649271402,    -0.3718055559285364,
        -0.29738287267912844,  -0.18038567876871994,   -0.6281321517957127,
        -0.08923552369391767,  -0.18590280323105288,   -0.27632958496418686,
        -0.22774370639488997,  -0.2445754755305008,    -0.4369233593399183,
        -0.4962168417703838,   -0.25316220478289314,   -0.5351213032472182,
        -0.15676598662212282,  -0.2209729509870032,    -0.35210471999416243,
        -0.3287006992297134,   -0.5588812920826398,    0.0022213390065605925,
        -0.12820410571232715,  -0.3735558991493478,    -0.3602564856451783,
        -0.43054746827598595,  -0.30585020291795356,   -0.3967859172953005,
        -0.2556694549753808,   -0.1425891445402888,    -0.1934215284835433,
        -0.0938292324276227,   -0.3310866427463198,    -0.32352522083632507,
        -0.446647622753415,    -0.6064645942573877,    -0.13069836815188637,
        -0.21515291594879923,  -0.6189553575169101,    -0.1089402855202246,
        -0.10632900234761798,  -0.3985096210414539,    -0.5076334283716103,
        -0.25845656263533057,  -0.1827242478429116,    -0.08145322986086585,
        -0.34168194775149824,  -0.2559651538702354,    -0.11661604337924221,
        -0.5195554712277838,   -0.5304030347917935,    -0.30557916409027813,
        -0.06258226090149092,  -0.14572911422627577,   -0.3255105033153813,
        -0.4564297963596931,   -0.1012132196454793,    -0.19389134098749414,
        -0.22221914637079287,  -0.4219391184703454,    -0.14084301540370603,
        -0.28796253722828474,  -0.1845209376036424,    -0.19707271822349398,
        -0.20803652871833622,  -0.10646792489015153,   -0.34006034030217897,
        -0.400359065210104,    -0.4330866962302683,    -0.26222660947133736,
        -0.542891141058653,    -0.18443521854153244,   -0.3159813392256306,
        -0.44393897642524865,  -0.1987743297763658,    -0.24579149942400816,
        -0.3352452757067735,   -0.558175525883064,     -0.259396654005771,
        -0.5427100948449848,   -0.16761249256177907,   -0.26425447306997896,
        -0.42094442389433756,  -0.26152516538324844,   -0.7493438636454549,
        -0.0562735522092741,   -0.3789349218345208,    -0.20123427343552708,
        -0.4623744326021754,   -0.30432224850001943,   -0.11224811344692275,
        -0.502967077059648,    -0.37971239275195895,   -0.536665574770665,
        -0.4228116524548043,   -0.17421239088923515,   -0.36687174314636933,
        -0.5424022316894951,   -0.5053569110599839,    -0.8880554835849342,
        -0.4380026294714078,   0.01933478047524716,    -0.7258819050405269,
        -0.16891356436120483,  -0.11538738366235521,   -0.4720815815397755,
        -0.41790263626676044,  -0.2855320328413396,    -0.18817231707424797,
        -0.3795492741779157,   -0.5177223627740726,    -0.4357642157204079,
        -0.05627781001590922,  -0.8205302661509507,    -0.4732532119890771,
        -0.3548153722689488,   -0.298675402588759,     -0.35500611303349405,
        -0.25027878408257515,  -0.45296364034441317,   -0.30197065873184126,
        -0.3657937443048403,   -0.4472033927022152,    -0.6158795336547952,
        -0.4788800297668932,   -0.47506228445958704,   -0.18226853772278465,
        -0.5492552417026949,   -0.14524343017333904,   -0.11022334142925262,
        -0.21081446214571445,  -0.5222922864570125,    -0.6354658936978828,
        -0.5963651879778071,   -0.6456519190376511,    -0.10301668638211778,
        -0.44986846297371363,  -0.3589746933538576,    -0.276791332884771,
        -0.48714735286320976,  -0.12075308312663409,   -0.6567197376131643,
        -0.577094321592194,    -0.7612587299671904,    -0.3286969586042314,
        -0.1827405185876289,   -0.5301352915284248,    -0.42700735760690245,
        -0.6243079561076692,   -0.185650490072125,     -0.29216979692329825,
        -0.24461437440813144,  -0.45426865175342285,   -0.24376303338647823,
        -0.13086157337859658,  -0.5006945902229594,    -0.3345999342789662,
        -0.499012727387847,    -0.3889165240213142,    -0.10342785215513067,
        -0.6148360208506651,   -0.4000498343596545,    -0.4229852996393009,
        -0.865982772013129,    -0.42432659845488424,   -0.03960567233492583,
        -0.6466152335593799,   -0.1404536310917117,    -0.24414879970273867,
        -0.4595953164784643,   -0.433050791653239,     -0.29620698459360206,
        0.021533689695443347,  -0.4029444576295093,    -0.6037058924419618,
        -0.5615099975256334,   -0.20788176928928784,   -0.765584619745285,
        -0.5993833195008202,   -0.3899926618063534,    -0.4155804381418301,
        -0.3783495889325245,   -0.23391988453445692,   -0.47552536428057574,
        -0.24087285874887182,  -0.35873920740073645,   -0.4700036777222814,
        -0.49761787205445684,  -0.3425604129054041,    -0.4653147662718112,
        -0.2525542106193548,   -0.5136522000303831,    -0.15326807859450658,
        -0.030854964836474964, -0.3015602939169306,    -0.48004280245280223,
        -0.6774730696099799,   -0.5324755303720331,    -0.6870020894193747,
        -0.06322839138784248,  -0.43960528206529226,   -0.4160482938887914,
        -0.3495478548280985,   -0.4822808974511798,    -0.14232820796831536,
        -0.6318226685922723,   -0.605403410916903,     -0.824172757680685,
        -0.38214961523184937,  -0.11329245657334897,   -0.5711710397485338,
        -0.24284294112330893,  -0.9655270012383542,    0.2676544076117087,
        -0.07005196752198978,  0.28557614055176417,    -0.7968829577512186,
        1.2371551376680185,    0.6783014607470312,     -0.030217995193949354,
        -0.5700197849317261,   -0.674879704072106,     -1.1317941969248517,
        0.3262731242121408,    -1.0257282003318173,    -0.2442365341175044,
        -0.6808865237011049,   -2.390780631309852,     -1.018462379267868,
        0.4144719334990313,    -1.5576216987355465,    0.204694613082151,
        0.1533947321608345,    0.13007737823873658,    0.2737005872914187,
        0.40037467772021246,   0.4472257207419119,     -0.2331750537545286,
        -0.7727596987505398,   -1.0553291574652768,    0.331339939792188,
        -0.9118497617679648,   0.09680633762418375,    -1.0846909719471254,
        -0.8277303041200607,   -0.6991914278385641,    0.20718000686725926,
        0.39576235737472637,   -0.7960263558744335,    0.08852970461491708,
        -0.5810140899434401,   -1.2822117142214442,    -0.6311117882669053,
        -0.3146335365317503,   0.2653711626290395,     -0.49174327347505054,
        0.28735380548040157,   0.3271561086138124,     0.4327820069965074,
        0.23220840998061185,   -1.0126340436545513,    -0.5639933846579945,
        -0.9796280889469816,   0.2423022698706785,     -0.47911428886501056,
        0.3774079275389244,    -0.21170110180098578,   -0.7225285637511167,
        0.28113010555382756,   -0.5666817537562094,    -0.7423161254629488,
        -1.7120606149943924,   -1.458342457975721,     0.7869512893092033,
        0.20822363167054822,   0.13774407135405056,    -0.5601543079884533,
        -0.03784017074717188,  -0.24112505663185127,   -0.1624158773766307,
        -0.6003707240588638,   -0.22569088356756256,   -0.007478905505216169,
        -0.4475015354147884,   -0.35165764767667806,   -0.4997911240443428,
        -0.45678578531921527,  -0.0991958392091228,    -0.3699457930965816,
        -0.45448783948564747,  -0.33495783462322914,   -0.8966931827671446,
        -0.3873839173913218,   -0.08819964858667806,   -0.6572043765258189,
        -0.14820128661905324,  -0.058307243939285644,  -0.49370260521757964,
        -0.3615666045505254,   -0.365388177135145,     -0.010351940731545535,
        -0.48775378963583765,  -0.6474278915770111,    -0.5466042646940482,
        -0.09016470676024413,  -0.8829812236427685,    -0.535905151821481,
        -0.4780387674132099,   -0.3882632186100982,    -0.43799348054689674,
        -0.09363611422400199,  -0.33885302836306197,   -0.19805969058555511,
        -0.2977755699801601,   -0.5567393601320156,    -0.627253120704295,
        -0.4768988976159418,   -0.38646825339072066,   -0.1469875853190514,
        -0.36288435059106056,  -0.05780680655918256,   -0.10873290918438791,
        -0.33276848265167036,  -0.5607986380466478,    -0.5339493780080685,
        -0.5479559353673342,   -0.7853049693766037,    -0.16407504297412728,
        -0.5955873888860732,   -0.31791129676585284,   -0.3757102241749667,
        -0.44981413396237563,  -0.1483342897755092,    -0.6873913758293265,
        -0.48477165255014887,  -0.7375868522804423,    -0.3580910182629931,
        -0.20470800899579714,  -0.5425637620890689,    -0.2698538577205283,
        -0.6612617431615759,   -0.16684098330004052,   -0.26778682021674854,
        -0.20286558112823094,  -0.5406247897938182,    -0.27512193724562606,
        -0.11966900634725623,  -0.5623368087988503,    -0.3301634572479055,
        -0.4498483818438568,   -0.5629516308238034,    -0.30939845556938556,
        -0.5069855034480374,   -0.49486760963195914,   -0.2748683161744549,
        -0.8042461205395723,   -0.4466922299115156,    -0.053864536378273244,
        -0.6850688315694571,   -0.22440936622280996,   -0.1905829698462067,
        -0.4204522503532647,   -0.4460812434097332,    -0.3718891948951135,
        -0.11827630941254541,  -0.3812454241197789,    -0.5033346663690879,
        -0.41028044719542844,  -0.03267046798280652,   -0.8050740465361697,
        -0.5341779913342993,   -0.4226155495664652,    -0.2762804344827068,
        -0.4858417606639264,   -0.22355010670829237,   -0.46640656399654923,
        -0.20943497752437457,  -0.3779484528273362,    -0.5045881653571448,
        -0.4866268101239322,   -0.3095628245521926,    -0.40102642866118166,
        -0.33200247360997653,  -0.4078172011087661,    -0.1574259242623821,
        -0.2091653988276616,   -0.31702251856493163,   -0.5659276266287211,
        -0.7361803075687824,   -0.520119103138584,     -0.7757635265746985,
        -0.22194559100651923,  -0.5098579644322889,    -0.5190491943850402,
        -0.36666357709381875,  -0.44521412847425795,   -0.10832980148396247,
        -0.5057162759511109,   -0.5895047219459941,    -0.8002767472269244,
        -0.468242930298682,    -0.31251232491988246,   -0.5197433613824762,
        -0.3067348784908486,   -0.07657339549586809,   -0.6318197206002909,
        -0.10261668312626622,  -0.591888846243016,     -0.3659561295163411,
        -0.18858844783210946,  -0.430857972002552,     -0.5672754586825861,
        -0.3195982059178293,   -0.49787586415236307,   -0.3765874658996832,
        -0.553552680834467,    -0.29507939114332626,   -0.413177948590116,
        -0.2696512783566034,   -0.08445299310088926,   -0.4585863862324239,
        -0.4919617512516912,   -0.33028196405895727,   -0.49540566299741184,
        -0.512065172994867,    -0.3002008210052945,    -0.27474030232271573,
        -0.18716888547577318,  -0.43713184973284425,   -0.454878512318606,
        -0.1776553104440813,   -0.4237101587515494,    -0.41520728634167553,
        -0.21204054461655408,  -0.23900419740350531,   -0.36198503225434253,
        -0.40855715930484304,  -0.4108831128411587,    -0.5941328578880981,
        -0.46780683610261964,  -0.5652956504244161,    -0.5902158247536182,
        -0.40678402803104224,  -0.27432855553167007,   -0.5184183533568206,
        -0.42059909544887863,  -0.3045439158926054,    -0.6583830545854363,
        -0.38514466346729653,  -0.5479022879142835,    -0.3599413172044171,
        0.003863802494734799,  -0.5430893555997398,    -0.30867619660664236,
        -0.1301903611531369,   -0.23430078497410894,   -0.5774990589422252,
        -0.38952227287650276,  -0.3322145370347436,    -0.20456627257964544,
        -0.3371886963676651,   -0.3206420228099316,    -0.2650534004337754,
        -0.1048684802875697,   -0.41761672601837624,   -0.3136943138268042,
        -0.3486768383232669,   -0.44303083635003215,   -0.13874869687203742,
        -0.5732262262098273,   -0.30042531530932925,   -0.45292240759147057,
        -0.3743027613721583,   -0.41687710265467465,   -0.38473511713929315,
        -0.5168390632109612,   -0.23195680462965257,   -0.35360900048170074,
        -0.3233493671462038,   -0.5317635014046075,    -0.2398609824739378,
        -0.37313320279556406,  -0.16473772835041686,   -0.05188302683872366,
        -0.40085890969049576,  -0.42669693136116704,   -0.38242994182717216,
        -0.5790887153675413,   -0.6121260543686319,    -0.32022421101419724,
        -0.32252618192378363,  -0.22839865413156732,   -0.4901532560669283,
        -0.45243264448032283,  0.03153060951275594,    -0.4848623839092533,
        -0.35120996486493816,  -0.23687268988946986,   -0.24163104837180524,
        -0.4354392395456605,   -0.3858304619164804,    -0.5098123967109065,
        -0.6120864428959437,   -0.2616013841979896,    -0.46056224834932175,
        -0.5585645617109836,   -0.43952250679707044,   -0.14181520043556936,
        -0.5423695261058331,   -0.449579422620805,     -0.45564409349013146,
        -0.7531934784949744,   -0.3124795209801566,    -0.6579490630400843,
        -0.38461681910355683,  -0.12368432526156053,   -0.43344288779116197,
        -0.33320445634756896,  -0.1589917529070029,    -0.25342752159712173,
        -0.7067866510661543,   -0.31754443749068534,   -0.4506915166013474,
        -0.20975109301575967,  -0.26661285985799305,   -0.27258401373939906,
        -0.30792229895652273,  -0.272388090795651,     -0.33545729657432216,
        -0.3112877635247058,   -0.3665021740961887,    -0.4586732643645359,
        -0.09137705251665908,  -0.43576610510226754,   -0.21863212612497374,
        -0.4717256648290963,   -0.49467277562656137,   -0.3551877399496071,
        -0.23909955792010076,  -0.5449081930420273,    -0.3949207419532633,
        -0.33354901066189346,  -0.36274717762920256,   -0.5973699957702189,
        -0.2665692378050951,   -0.36335326788021116,   -0.15955914977294763,
        -0.08781505758997038,  -0.3887445432480447,    -0.5976681085999581,
        -0.3898236507880556,   -0.541805840048102,     -0.627278146465794,
        -0.26984377954399136,  -0.288378084564342,     -0.23371918751157472,
        -0.2699622775235503,   -0.6299649179233333,    0.013839418566884818,
        -0.40716222699048765,  -0.4581323934548808,    -0.14457752098468618,
        -0.37338857239107676,  -0.4530932935070715,    -0.38937397577353977,
        -0.4520525063459829,   -0.5023444688292817,    -0.39374105883514465,
        -0.4817341436998321,   -0.5389102044373476,    -0.27886312476578456,
        -0.14769334433740447,  -0.4397851644224194,    -0.37602359725774964,
        -0.34543294687347553,  -0.6721179039741105,    -0.276128971154213,
        -0.6977741127030261,   -0.37146814144360474,   -0.19659037493251175,
        -0.339238120817425,    -0.27626799072164504,   -0.1756009425449741,
        -0.22924880619023255,  -0.7113334645850871,    -0.31727033096975243,
        -0.37145785994653413,  -0.27102551564889493,   -0.3856943369506245,
        -0.22648179855323877,  -0.40002402541434723,   -0.2647401868878344,
        -0.3100771364005516,   -0.3877167632868043,    -0.39457048757442,
        -0.33212497343127606,  0.40483638406279376,    -1.2570455864226535,
        -0.729291543174965,    -0.4103013048515699,    0.05225043174475388,
        -1.0361928382902126,   0.7717275326788781,     -0.5360841169292397,
        -0.1356792749486326,   -0.3000381483085485,    -0.06582875548921757,
        -1.8296265656589712,   -0.03968875747677652,   -0.5724970054168503,
        -0.5633085101865912,   0.2579277479334326,     -0.704236763111685,
        -1.7278837588729257,   0.234911622527884,      -2.1806818058150483,
        -2.1981019257518395,   -0.19682088610087575,   0.8784239131979326,
        -0.32710293419362924,  -0.7838139202232922,    -1.403409209825393,
        0.5682646468553489,    -0.09820952744088415,   -1.344298839585754,
        0.2063553037230384,    0.15635817144312017,    -0.334446201947116,
        -1.1692934532335055,   -1.445587662224243,     -1.595201492620365,
        -0.12856178842865765,  -1.1665531641085332,    -1.5227534093732276,
        -0.7711428928738492,   0.36067574602525204,    -0.9784474260172434,
        -0.6861738453372224,   -1.630115378486445,     -1.3043724852593,
        0.4379049297735026,    -1.6121689942424922,    -0.5169503798517266,
        0.6767001606174934,    0.1971436659149425,     0.1790181291370963,
        0.5621082555297175,    -0.629984474284482,     -0.4212988357019308,
        -0.6358379861254017,   -0.7676135757291843,    -0.2952813243702671,
        -0.055779654186547144, -0.23586182075309856,   -0.1592591415730102,
        0.22185202891782058,   -0.25511399623189973,   -0.8678983465929242,
        0.5000867906121813,    -0.3731355295859995,    -0.11049777697199821,
        -0.6821503888802963,   -0.3232606588811084,    -0.5673013215271097,
        -0.4507004292920003,   -0.21161298987710675,   -0.3855207868991884,
        -0.5101065344456124,   -0.3728299802155125,    -0.4631160426312079,
        -0.29905145351048174,  -0.45561070332905407,   -0.2564191955508623,
        -0.35737327020671683,  -0.23583873805568015,   -0.12940415444415415,
        -0.43768126718232747,  -0.5882076802410962,    -0.40765193536072397,
        -0.4918623775795396,   -0.5740431233911163,    -0.4257011539740279,
        -0.18441593093633177,  -0.25840218747197485,   -0.330004858100257,
        -0.6123725572051717,   -0.08603087896406779,   -0.3883694573964027,
        -0.37714833704333206,  -0.2701062206988277,    -0.23941142079778105,
        -0.37885668822226415,  -0.3821455408354329,    -0.4548746687527652,
        -0.5341189388637231,   -0.2642919728489363,    -0.3983283571049382,
        -0.613738437677303,    -0.4123452919814164,    -0.24409598081002337,
        -0.39549113318480494,  -0.4432740195159267,    -0.37799283270475864,
        -0.612228373263522,    -0.3239463582137672,    -0.6622604305441822,
        -0.467700303546382,    -0.07956315494979062,   -0.5334051683422739,
        -0.23321740007337874,  -0.09941667488196108,   -0.2883212893017547,
        -0.5700579848677629,   -0.264176707455863,     -0.35110884204143555,
        -0.22550492733111327,  -0.3091596873346098,    -0.31861876343490386,
        -0.30731453519807733,  -0.204226634358478,     -0.44015444514699814,
        -0.4402987365177473,   -0.39430238087338615,   -0.33718206953580415,
        -0.17109685041721803,  -0.7972629585814349,    0.5992439970223167,
        0.3782760052478714,    0.09220331182345895,    0.31934199798442997,
        0.09499216158514721,   0.3245842800336211,     -0.7901017258884763,
        0.012139211551073103,  0.5765655850347559,     -0.21670327331770237,
        0.4164294586237276,    0.5224249267697111,     0.39310257670220117,
        -0.15068123746623832,  -0.041518832321651475,  -0.17752328262781264,
        0.6204195359067757,    -0.5779434084945309,    -0.7854299196881558,
        0.03387570816293656,   -0.37619871440917035,   0.48094261615128425,
        -1.0493620134350927,   0.40720144200985986,    0.12477627953943,
        -0.07527672270365471,  -1.5891218027832295,    -0.14503705469978945,
        0.5309133249508439,    0.1904329836642691,     0.15192770527650523,
        0.6852290454532146,    -0.34754734589302305,   0.1683668672901606,
        0.3083712637547248,    0.20952778485149132,    0.5058650011426364,
        0.24604222828999442,   0.1054465588434676,     0.2953571707232315,
        -0.4580397426871814,   0.2030858787410552,     -0.5393507157748585,
        -0.17273333770021382,  0.31612651156947263,    0.22462067494900492,
        -0.06737038959569165,  -0.5211901864870132,    -0.12066935598813901,
        0.13116149380028985,   0.40867035376147554,    0.49095689326538045,
        0.2661274959002592,    0.5091176934414193,     0.0412192857940439,
        0.3959054019650839,    0.3291054067855488,     -0.7549261719914095,
        -0.27102433812653104,  0.023591687422172644,   -0.6164880388713186,
        -0.05863126816268858,  -0.04015690777858813,   -0.30466228722987027,
        -0.12941384450691074,  -0.300243650034606,     0.12010004432027338,
        -0.15481734592339477,  -0.2725111954977923,    0.0454080284604773,
        -0.23514699560504612,  -0.3138903087849889,    0.11011339155963101,
        -0.23722438669672383,  0.09316973615454378,    0.04301516828221528,
        -0.12137819040385259,  -0.1441471663126252,    -0.07288167450160839,
        -0.34713899719137425,  -0.09078623420180974,   -0.414723055575042,
        -0.2962705128559682,   0.07643424617751071,    -0.337303286617441,
        -0.08575053443815106,  -0.3543829923450584,    -0.04225053638047802,
        -0.1717402308208845,   -0.21386688547254135,   -0.15596790697119609,
        -0.10119303884601802,  -0.08324416708862102,   -0.10911872461204411,
        0.08090347077903962,   0.014897258302171795,   -0.329877222531537,
        0.03993884828316867,   -0.2156063374641574,    -0.10096087500751756,
        -0.10490497837969906,  -0.13107184114473233,   -0.2519684102147274,
        -0.06696024599226115,  -0.18168946013855278,   -0.04171880977134739,
        -0.3476218617135818,   -0.3387821809607443,    -0.13391740349379047,
        -0.2212096140831285,   -0.32027134369741683,   -0.2933263759326216,
        -0.30231507251311035,  -0.1346903122636184,    -0.15693881512385366,
        -0.08434981293273787,  -0.1742565539607633,    0.06771233431960826,
        -0.06280790637629244,  0.021137077705836848,   -0.11751763068727776,
        -0.27586588660364864,  -0.1595363286299842,    -0.11979850139890205,
        -0.37129080544018356,  -0.09047370763262243,   -0.1731322429013682,
        -0.19475776096118566,  0.07912300976693558,    -0.19326851587495777,
        0.10591495372139868,   -0.11820685226224248,   -0.2262971187953502,
        -0.01596187560181142,  -0.0938304658625458,    -0.12267547704235718,
        -0.03032244357425707,  -0.3945894743958677,    -0.09596203461418557,
        0.11048083329149526,   -0.07175287902522252,   -0.1757762143500961,
        -0.25069021911960787,  -0.3854679605887108,    -0.15098880667548412,
        -0.23792314689945673,  -0.3245807587361249,    -0.046039754734985484,
        -0.3215122490135165,   -0.11931715425521694,   -0.35837491201428945,
        -0.1296614812898686,   -0.0022530213309731872, -0.02534277944817278,
        -0.2532051565201152,   -0.20488781090827626,   -0.012219071749760248,
        -0.07573021509714019,  0.06085003615689906,    0.00654004740936381,
        -0.24022092447641494,  -0.09994046372937755,   -0.2029865750211748,
        -0.018406602159286748, 0.0095573896554007,     -0.1059195762579236,
        -0.23372307401044387,  -0.11711055621639396,   -0.04271319165854146,
        -0.2822345106761146,   -0.23165842926432756,   -0.37878053217712737,
        -0.32043184776393696,  -0.0790175770098441,    -0.3603125224116009,
        -0.3109785537222507,   -0.24240224101361674,   -0.18690635333871794,
        -0.29952474790114697,  -0.16067280877047582,   -0.032207961671638884,
        -0.01789687107213428,  -0.2577159120973457,    -0.024273248831655478,
        -0.13190800265680436,  -0.18378626462372857,   -0.14120581367542695,
        -0.057069748438877924, -0.48944301920112687,   -0.21566558604804997,
        -0.09409751034947243,  -0.15661381712898556,   -0.14973116509233259,
        -0.24162172825344305,  0.022312598970214214,   0.035463866789234216,
        -0.3069864438010644,   0.04931471710659128,    -0.21691901801433838,
        -0.2506282404145851,   -0.026822499672280092,  -0.20008936155504645,
        -0.13446221056631752,  0.08395112604948715,    -0.03818813201611244,
        -0.14712923035712802,  -0.04071062045122648,   -0.31293575275419283,
        -0.21595585819575716,  -0.34628661466049515,   -0.23870846268835744,
        -0.083058397274164,    -0.34239962718583844,   -0.10091252790246953,
        -0.31807338413468894,  -0.08069812674848409,   -0.2247259396821154,
        -0.13816581459451316,  -0.24552013857858263,   -0.3064102439246135,
        -0.023224908697165893, -0.12374675403040647,   -0.04639132616762583,
        0.009729572420204146,  -0.19331129568480043,   -0.20293664548999013,
        -0.12530362667507283,  -0.06628349634417079,   0.05415434267589006,
        -0.13018296118094927,  -0.20310118192252166,   -0.0750938834929491,
        -0.13635981611956396,  -0.2639319191408504,    -0.4421969975860739,
        -0.44233991744374374,  -0.2672271422923424,    -0.19641758011170668,
        -0.41325682937561936,  -0.3949653519035195,    -0.17983904537048062,
        -0.13733928300084813,  -0.22809181235874068,   -0.04557509375636655,
        -0.07034659488495924,  0.05973148889490038,    -0.24943078962413928,
        -0.0688346242419239,   0.05217010600813401,    -0.09105314136343039,
        -0.30998023456026985,  -0.19524495219290772,   -0.38067696154148567,
        -0.2325795532247075,   -0.18757145370655692,   -0.5636244230855417,
        0.8795206273624668,    -0.16172543178659507,   0.3592117276882199,
        0.9839378306935957,    -0.9287939316298551,    0.4901274829617619,
        -0.022271872229786337, -0.4443145901006851,    0.07019214272332532,
        -1.0516291712433696,   0.12134516287264333,    0.5741076934689583,
        0.516500757754052,     0.0964794396201143,     0.17664693857627856,
        -0.7643980266390847,   0.0936973805936191,     -1.1391061748673972,
        -1.1708983592732347,   0.4432144507751881,     -0.9412627850614773,
        0.536569138332142,     0.18734337025588663,    0.669517160408386,
        -0.41092611681330715,  0.2345069086208032,     0.4735240037537158,
        0.23670665404650487,   0.182906111879774,      0.5412279057816007,
        0.512244838698162,     0.5279302090155922,     -0.1301803641376022,
        0.2979493696741087,    0.013902467001928875,   -0.23477102416739665,
        0.9642152125683326,    -0.20724024716124656,   0.25176232568090445,
        0.1473804418798421,    0.7652103374149256,     -0.36072673023608903,
        -0.864345468237662,    -1.0778414334703403,    0.25886287953210285,
        -0.9941857483918202,   -0.28773365469098966,   -0.885084056144438,
        -0.4604196998324587,   0.5457628773589003,     -0.9571110522851844,
        0.5888730436336528,    0.45452303850184056,    0.6400293694174921,
        0.19699139958922887,   0.501273257120179,      0.24908494932305086,
        0.2454719870878251,    -0.48538465042611656,   0.7097997129800901,
        -0.22235744621697887,  0.589222348158953,
    };
const float linner_layer2_bias[NETWORKS_LINNER2_SIZE] = {
    -0.1128, -0.6471, -0.4864, -0.6386, -0.5540, -0.7145, -0.7292,
    -0.2110, -0.8739, -0.6992, -0.6413, -0.4996, -0.6519, 0.3217,
    -0.5921, 0.0096,  -0.2561, -0.3725, -0.3053, -0.0343
};

const float batch_normal_weight[NETWORKS_BATCHNORMAL1D_SIZE] = {
    4.5441, 3.3605, 2.9124, 3.2150, 4.9545, 1.0000, 3.4416, 3.8911,
    4.9683, 3.3955, 3.4918, 0.9543, 3.5710, 4.1361, 4.7173, 4.3815,
    2.5728, 3.7531, 3.5959, 2.2458, 3.8433, 2.8044, 3.2782, 3.4944
};
const float batch_normal_bias[NETWORKS_BATCHNORMAL1D_SIZE] = {
    -0.1620, -0.0573, -0.0095, -0.0752, -0.0760, -0.2000, -0.1643,
    -0.0859, -0.0585, -0.1181, 0.0390,  0.0920,  0.0093,  -0.1699,
    0.0578,  0.1275,  0.1550,  0.0193,  -0.2226, 0.0381
};
const float batch_normal_running_mean[NETWORKS_BATCHNORMAL1D_SIZE] = {
    2.2102e+05, 8.7482e+05, 5.5105e+05, 1.9866e+06, 3.7831e+05,
    7.8436e+05, 5.2896e+05, 2.6593e+00, 2.5215e+00, 2.7296e+00,
    1.7416e+06, 1.8176e+06, 1.8531e+06, 8.7767e+05, 1.1859e+06,
    6.2845e+05, 6.3391e+05, 2.9064e+00, 2.8881e+00, 2.6490e+00
};
const float batch_normal_running_var[NETWORKS_BATCHNORMAL1D_SIZE] = {
    1.1948e+11, 2.8372e+12, 1.1502e+12, 1.8227e+13, 4.2779e+11,
    2.2550e+12, 1.2719e+12, 5.0289e+00, 4.5227e+00, 5.2230e+00,
    2.2900e+12, 1.4042e+13, 1.5652e+13, 2.9710e+12, 6.2883e+12,
    1.7611e+12, 1.9336e+12, 7.0824e+00, 6.6088e+00, 5.9069e+00
};

// const float hidden_layer_bias[NETWORKS_OUTPUT_SIZE] = { 1.4795401096f,
//                                                         -1.3724881411f };
const char *action_list[11] = {
    "jumping_squat", "jumping_jack", "jumping_lunge", "sit",
    "squat",         "trot",         "walk",          "wave",
    "lunge",         "good_morning", "tuck_jumping"
};
static int linear_calculation(NetwoksLayer *layer, LayerData *input_data,
                              LayerData *output_data)
{
    uint16_t i = 0, j = 0;
    float tmp_sum = 0.0f;

    if (!layer || !input_data || !output_data) {
        return NET_ERR_GENERIC;
    }

    if (input_data->size != layer->row_num ||
        output_data->size != layer->column_num) {
        return NET_ERR_GENERIC;
    }

    for (i = 0; i < output_data->size; i++) {
        tmp_sum = 0.0f;
        for (j = 0; j < layer->row_num - 5; j += 5) {
            tmp_sum +=
                input_data->data[j] * layer->weight[i * layer->row_num + j];

            tmp_sum += input_data->data[j + 1] *
                       layer->weight[i * layer->row_num + j + 1];

            tmp_sum += input_data->data[j + 2] *
                       layer->weight[i * layer->row_num + j + 2];

            tmp_sum += input_data->data[j + 3] *
                       layer->weight[i * layer->row_num + j + 3];

            tmp_sum += input_data->data[j + 4] *
                       layer->weight[i * layer->row_num + j + 4];
        }

        for (; j < layer->row_num; ++j) {
            tmp_sum +=
                input_data->data[j] * layer->weight[i * layer->row_num + j];
        }

        tmp_sum += layer->bias[i];
        output_data->data[i] = tmp_sum;
    }

    return NET_NORMAL;
}

static int relu(LayerData *input_data)
{
    uint16_t i = 0;
    if (!input_data) {
        return NET_ERR_GENERIC;
    }
    for (i = 0; i < input_data->size; i++) {
        if (input_data->data[i] < 0.0f) {
            input_data->data[i] = 0.0f;
        }
    }
    return NET_NORMAL;
}

static int batch_normal1d(LayerData *input_data)
{
    uint16_t i = 0;
    for (i = 0; i < input_data->size - 5; i += 4) {
        input_data->data[i] =
            ((input_data->data[i] - batch_normal_running_mean[i]) /
             sqrt(batch_normal_running_var[i] + EPS)) *
                batch_normal_weight[i] +
            batch_normal_bias[i];
        input_data->data[i + 1] =
            ((input_data->data[i + 1] - batch_normal_running_mean[i + 1]) /
             sqrt(batch_normal_running_var[i + 1] + EPS)) *
                batch_normal_weight[i + 1] +
            batch_normal_bias[i + 1];
        input_data->data[i + 2] =
            ((input_data->data[i + 2] - batch_normal_running_mean[i + 2]) /
             sqrt(batch_normal_running_var[i + 2] + EPS)) *
                batch_normal_weight[i + 2] +
            batch_normal_bias[i + 2];
        input_data->data[i + 3] =
            ((input_data->data[i + 3] - batch_normal_running_mean[i + 3]) /
             sqrt(batch_normal_running_var[i + 3] + EPS)) *
                batch_normal_weight[i + 3] +
            batch_normal_bias[i + 3];
    }
    for (; i < input_data->size; ++i) {
        input_data->data[i] =
            ((input_data->data[i] - batch_normal_running_mean[i]) /
             sqrt(batch_normal_running_var[i] + EPS)) *
                batch_normal_weight[i] +
            batch_normal_bias[i];
    }
    return NET_NORMAL;
}
static int max_pool(LayerData *input_data, LayerData *output_data)
{
    uint16_t i = 0;
    float max  = input_data->data[0];
    for (i = 1; i < input_data->size; ++i) {
        max = max > input_data->data[i] ? max : input_data->data[i];
        if ((i + 1) % NETWORKS_POOL_SIZE == 0) {
            output_data->data[i / NETWORKS_POOL_SIZE] = max;
            max                                       = -100000;
        }
    }
    return NET_NORMAL;
}

int networks_init(void)
{
    memset(&bp_networks, 0, sizeof(BpNetworks));

    bp_networks.linner_layer1.row_num    = NETWORKS_INPUT_SIZE;
    bp_networks.linner_layer1.column_num = NETWORKS_LINNER1_SIZE;
    bp_networks.linner_layer1.weight     = linner_layer1_weight;
    bp_networks.linner_layer1.bias       = linner_layer1_bias;

    bp_networks.linner_layer2.row_num    = NETWORKS_LINNER1_SIZE;
    bp_networks.linner_layer2.column_num = NETWORKS_LINNER2_SIZE;
    bp_networks.linner_layer2.weight     = linner_layer2_weight;
    bp_networks.linner_layer2.bias       = linner_layer2_bias;

    return NET_NORMAL;
}

static ClassResult result_classification(LayerData *hidden_layer_output)
{
    uint16_t i = 0, j = 0;
    for (i = 0; i < hidden_layer_output->size; i++) {
        if (hidden_layer_output->data[i] > hidden_layer_output->data[j]) {
            j = i;
        }
    }
    return (ClassResult)j;
}
void dump_layer(LayerData *input_data)
{
    for (int i = 0; i < input_data->size; ++i) {
        printf("%f ", input_data->data[i]);
    }
    printf("\n\n");
}

int foward_process(LayerData *input_data, int *class)
{
    float linner_layer1_output_data[NETWORKS_LINNER1_SIZE] = { 0.0f };
    float linner_layer2_output_data[NETWORKS_LINNER2_SIZE] = { 0.0f };
    LayerData linner_layer1_output;
    LayerData linner_layer2_output;

    linner_layer1_output.size = NETWORKS_LINNER1_SIZE;
    linner_layer1_output.data = linner_layer1_output_data;

    linner_layer2_output.size = NETWORKS_LINNER2_SIZE;
    linner_layer2_output.data = linner_layer2_output_data;

    float hidden_layer_output_data[NETWORKS_OUTPUT_SIZE] = { 0.0f };

    LayerData hidden_layer_output;
    hidden_layer_output.size = NETWORKS_OUTPUT_SIZE;
    hidden_layer_output.data = hidden_layer_output_data;

    int ret;
    printf("asdsadasdas");
    dump_layer(input_data);
    ret = linear_calculation(&bp_networks.linner_layer1, input_data,
                             &linner_layer1_output);

    if (ret != NET_NORMAL) {
        printf("linnear1 wrong!\n");
        return ret;
    }
    dump_layer(&linner_layer1_output);
    ret = relu(&linner_layer1_output);

    if (ret != NET_NORMAL) {
        printf("relu wrong!\n");
        return ret;
    }
    dump_layer(&linner_layer1_output);
    ret = batch_normal1d(&linner_layer1_output);

    if (ret != NET_NORMAL) {
        printf("batch_normal1d wrong!\n");
        return ret;
    }
    dump_layer(&linner_layer1_output);
    ret = linear_calculation(&bp_networks.linner_layer2, &linner_layer1_output,
                             &linner_layer2_output);

    if (ret != NET_NORMAL) {
        printf("linnear2 wrong!\n");
        return ret;
    }
    dump_layer(&linner_layer2_output);
    ret = max_pool(&linner_layer2_output, &hidden_layer_output);

    if (ret != NET_NORMAL) {
        printf("max_pool wrong!\n");
        return ret;
    }
    dump_layer(&hidden_layer_output);
    *class = result_classification(&hidden_layer_output);
    printf("action:%s\n", action_list[*class]);
    return ret;
}
