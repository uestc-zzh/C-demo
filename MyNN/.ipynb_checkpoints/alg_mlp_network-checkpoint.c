#include "alg_mlp_network.h"

/* define the BP networks*/
#define NETWORKS_INPUT_SIZE (30) /* input data feature dimension */
#define NETWORKS_LINNER1_SIZE (32) /* hidden layer neuron number */
#define NETWORKS_BATCHNORMAL1D_SIZE (32)
#define NETWORKS_LINNER2_SIZE (24)
#define NETWORKS_POOL_SIZE (4)
#define NETWORKS_OUTPUT_SIZE (6) /* class number */

#define EPS 0.00001
#define FLT_MIN 1.175494351e-38F

#define NET_NORMAL 0
#define NET_ERR_GENERIC -1

/* weight: reshape the original [row_num, column_num] matrix into
 * [row_num*column_num, 1] along columns */
typedef struct NetwoksLayer {
    uint16_t row_num;
    uint16_t column_num;
    const float *weight;
    const float *bias;
} NetwoksLayer;

typedef struct BpNetworks {
    NetwoksLayer linner_layer1;
    NetwoksLayer linner_layer2;

} BpNetworks;

static BpNetworks bp_networks;

//* changed weight
const float linner_layer1_weight[NETWORKS_INPUT_SIZE * NETWORKS_LINNER1_SIZE] = {
    -0.973134380492561,    -1.467509375193316,    -1.3391505347306052,
    -1.8864621006111137,   -0.7180657808974834,   -2.0285279283494906,
    1.320949569650306,     -0.7182207416025633,   0.12695301238026752,
    3.3829044869752125,    2.910489796767462,     2.875370697156869,
    2.884483940918128,     1.8507063038043476,    2.3432701331557912,
    -0.85881819398129,     -2.1894246469614744,   -0.6699958407912608,
    -2.677774675723008,    -1.571126677790113,    0.19586895989247644,
    0.5824781878102416,    -0.22873700766791338,  -0.30281634012629793,
    1.4642974864531364,    1.1972384744790083,    2.504803492275699,
    0.6026436124849311,    0.7883569965381814,    2.6045854245885076,
    -1.190664580275883,    0.4724838618903984,    0.21787686942706758,
    -1.9157398125938905,   -0.4221141600714192,   -1.6441496399170181,
    4.476586331794474,     3.702536437355796,     11.27873181665082,
    6.287360084231576,     6.1529186299301495,    7.819587293740899,
    2.9525269339949722,    4.824610289883156,     2.0237720605521514,
    -0.006390313492384364, 0.6439149791301998,    -0.7707690341573837,
    -1.1881597725434832,   -1.8061575876579425,   -1.78441249650536,
    5.287818159371701,     3.960661838447531,     3.4270861609690786,
    6.8818287106656015,    3.5819640838001416,    6.033127942508473,
    2.713626529223821,     0.44223946163898414,   7.9973416706782565,
    -0.1551689263341626,   -0.07690324165860052,  0.0833284684595666,
    0.4647237278890633,    -0.12122775996449418,  0.09961403188777966,
    26.627354455575617,    18.446632670815074,    26.848321654659667,
    50.778198402816486,    55.26114192965602,     53.825977661944236,
    74.48293996827745,     71.50696528764539,     75.05390180987735,
    -0.14635969282404168,  -0.03590428093871143,  -0.1989331917254186,
    0.031744028657789324,  0.11496540661723605,   -0.08115412664875132,
    18.744448466967796,    19.891548715063404,    14.872418346880087,
    47.01370965106548,     53.28152349837985,     49.92690128560496,
    66.40525131913543,     79.21323463403257,     64.92915284783598,
    0.09277407744110171,   -0.13985412624570895,  -0.15102964187171738,
    0.06917596420641535,   0.08509532833247974,   -0.08501429429825574,
    0.028610832827326307,  -0.17876038997356064,  0.002301281325395072,
    0.044753089365305,     0.0017281768848158281, -0.02897998708394862,
    0.07599279283290639,   -0.050183534634055844, 0.13590708374185587,
    -0.15725742996280154,  -0.10434403292098976,  -0.15242285800621277,
    -0.16512139272586146,  0.1353508357158992,    -0.045185527227824575,
    -0.14341693243180859,  0.03786762253377971,   -0.1382553713770057,
    0.009437858868624329,  0.08679249872418818,   -0.03860652465327428,
    0.0938569903294594,    0.03747238217993319,   -0.146504879005718,
    -1.103864707187231,    -0.2739984422927426,   -0.7675277702596485,
    -0.593802905204131,    -1.3578039525585586,   -0.2488455655158783,
    0.08481794076275424,   0.28517946010069417,   0.2733446859990955,
    0.5090887946583456,    0.2808236509185723,    0.4233533217720308,
    0.17361678312793694,   0.2872953456403311,    0.4105753344613336,
    -0.214322552914263,    -1.108144992640486,    -1.0575660200228054,
    -0.14858290916889608,  0.49039636501879713,   -1.7993294904599473,
    0.31306079231889666,   0.10640610122318479,   -0.7040531122985663,
    0.33571245795054017,   0.43319804190733113,   0.47294922012311447,
    0.4031389530522645,    0.3206632946645619,    0.4266295047491472,
    -0.7801916365508235,   0.706837114143349,     0.07127338216837596,
    1.2495842680331284,    0.11894618850587983,   0.05632233122679308,
    2.719065838650783,     0.3041983655330584,    13.669570173567342,
    22.061037539203067,    25.482313863336863,    23.567492794486533,
    -1.7142043166528595,   -2.342049793290253,    3.642926575105746,
    0.43174605514977116,   -0.3583534361107336,   -1.076147601459557,
    -0.9041212111672724,   -0.10002755944246997,  1.2896143108652482,
    7.303605218895832,     2.879743798566905,     7.926757676114247,
    27.889797604196474,    16.588385931193663,    19.349349588688096,
    6.57224613556878,      3.9127301216841905,    -2.1719441435962334,
    1.1493799250007932,    0.26479427662519334,   0.8351809406499319,
    -0.8504519690047101,   1.0167309671114657,    0.01632555948547448,
    25.68013494297828,     15.249860168057145,    28.666269212549693,
    18.865556207413988,    16.23983514419962,     19.853768048266552,
    36.13393544355589,     29.75936655463241,     33.80386740650207,
    -0.543963872721274,    -4.792351155536887,    -1.0915291528864948,
    -0.9267381819394988,   1.2068776009958988,    1.95261284314367,
    18.70438528060484,     14.504975256190274,    18.701613189837815,
    19.279432844295776,    19.26133775480122,     20.944186874152518,
    29.98210022848195,     24.231386328711647,    36.71153327699902,
    -0.8077109969713394,   -0.7096768264490694,   -0.8519629076018305,
    -1.326703752050829,    -1.2168498609610712,   -2.409284202081567,
    1.0724521593842447,    1.638646575707963,     3.8094977840424984,
    -0.8108576588745108,   -0.7990765475925268,   -0.8653037761868148,
    -0.5764940313649989,   -0.7505539423936937,   -0.5337723091010093,
    -1.1388783835925886,   -0.18803533666658728,  -0.28438758258413965,
    -0.753523381763462,    0.5903528542338561,    -0.18144850983077562,
    2.645195835753303,     1.926805776107318,     2.6258375061190895,
    -0.791097296495289,    -0.9648496005012615,   -0.4490861172378135,
    -0.467611223462797,    -0.7410147831912146,   -0.6621278698638007,
    0.5243266952002614,    -0.7835023044633865,   -0.8283271645067889,
    -1.2632995006646455,   -0.19908766704695097,  0.4428712165949559,
    3.359110509330793,     3.135509789681266,     1.0690194578725312,
    0.8527600897773251,    3.5608421210413823,    1.7760946539661104,
    5.438615338929576,     5.8250134676092555,    5.427165512126146,
    -0.13890485584632115,  -0.5192474136087006,   -0.28934029788019733,
    -0.687961134629767,    0.2840518390663898,    -0.1111566464415053,
    1.7399552113682175,    5.914276315896935,     2.3644664504825803,
    1.6146407671570664,    5.17216095038535,      3.588988953285656,
    5.10378163831796,      6.682534634829355,     0.9966468009544371,
    0.03442611989595252,   -0.36299300477957974,  0.05469686536765162,
    0.32575005749032376,   0.1482190315374721,    -0.25547784976381677,
    20.896527519050473,    7.323482274720096,     22.516538051656777,
    24.725820628393674,    22.6371242557944,      27.925390816037027,
    62.990120542733706,    54.7186518889668,      63.39629123169568,
    0.005431379875302873,  -0.019766593805537486, 0.14398564598400518,
    -0.18722546801536674,  -0.09589816705532911,  -0.08665187146260796,
    20.663924623269466,    17.191205969166482,    16.27111321338489,
    36.22534817981546,     35.82403168731419,     31.181990509352158,
    64.94501294476851,     58.26251200216773,     47.1666021375318,
    -0.140044966857322,    -0.683331644163248,    -0.3910976597618708,
    -1.3891006157097079,   -0.8001305461123563,   -1.1477916752361594,
    5.174213013988371,     3.083726281887165,     4.6581568278433,
    -3.508151676877558,    -3.749065418221793,    -4.293196087451447,
    -4.940709414278659,    -5.23849418275748,     -5.347474469890547,
    0.06695651756458221,   -1.2171795149224331,   -0.10616499084546534,
    -0.5900180549883417,   -0.8266905245301367,   -1.0733659066608048,
    7.076283565233644,     4.74444347463833,      2.9144817801339737,
    -3.637989246075682,    -3.47177721132718,     -4.294421391229837,
    -4.953260689320278,    -4.159985834219091,    -4.751815045763042,
    -0.6696515708107509,   3.0689334203061445,    0.24668780429047693,
    0.9326776866430361,    0.04845887831538212,   -1.6752055413685074,
    13.916707072717216,    17.303459315922584,    8.686640654753225,
    7.433293603517253,     1.3854934628693025,    7.6024061444887066,
    9.569969223943268,     1.5959172319310557,    6.144891071771936,
    0.016694275766558974,  -0.06190655866274653,  0.09984883849035801,
    -0.19535409666396142,  -0.8874900721276956,   0.37270774723114075,
    15.201954009412505,    2.6526455809536653,    2.141910879320864,
    0.3739320376375419,    -1.572599714059929,    7.150192755752805,
    9.992775264309923,     3.373783158915477,     1.2350242158489684,
    -0.50205603454212,     -0.9436065064858898,   -1.869524110464365,
    0.34052774249505324,   -0.8965345017951866,   -0.9472779569710964,
    0.8297317209535284,    0.5567905661892989,    -1.2570266221989748,
    -0.9578842825936608,   0.21347350492681125,   -0.6944479029089812,
    0.634730518700175,     1.0561494231016877,    0.6864610883595417,
    -0.9674066888028817,   -0.8171999343137617,   -1.8265561897548852,
    -1.5469519730097072,   -0.6087328825944256,   -2.3785811111018487,
    0.6636325613002307,    1.5787633977832847,    -1.7442599777138241,
    -0.21674021724478426,  -0.5778310741617592,   -0.8608970645251609,
    0.1316398906688621,    0.6169013832918363,    -1.218172686801796,
    -3.1999828332977502,   -2.5365310598107227,   0.6472934031738554,
    -3.951002493780317,    -2.7359496108009136,   -1.3653144447819023,
    -0.4797673452333178,   1.535259980153636,     1.509593010932443,
    1.0196203679360203,    1.4003085268059388,    1.3081878680866832,
    1.8450152175531545,    1.920007451843224,     1.8479798768206215,
    -0.15819988094066553,  0.9233318333336177,    -2.877287922540842,
    -2.441876268070786,    -1.6820835822672071,   -1.1793708704016632,
    2.302218901968664,     1.1513738712334247,    0.7818313568320501,
    1.0601080762765034,    1.3295766326709688,    1.269741376204853,
    1.8116720500838557,    2.0029767171212915,    1.6949360863929928,
    1.5717513904659028,    1.3340101516919574,    -2.6699426121213494,
    -0.8593455655334713,   1.0378055881109305,    0.04544498916174552,
    -1.9825681727120303,   -2.095038121267416,    -0.968929910176005,
    -3.924077019685917,    -8.627014067585515,    0.22648518373837082,
    -44.343860582105776,   -39.52525488208306,    -40.29993310193274,
    -1.2810576877696813,   -0.30599317644807866,  -0.3125592834731213,
    0.4018711651251832,    2.9528001122834175,    0.311944411069184,
    -4.8013159692223715,   -5.44742017006217,     5.688775778560956,
    -5.403777873325251,    -11.30181816921649,    -1.3936969144453182,
    -35.93528746653327,    -38.49446239336192,    -32.31357892890665,
    -1.4841834876052615,   0.15062330596043874,   -1.373174490337544,
    -0.39641339485462473,  -2.409657955519333,    1.3178475373901073,
    6.175746362848576,     4.262669511918147,     3.840278766090583,
    -1.7466142845997805,   0.1824793461495195,    1.3012498185158146,
    -1.7362526045637667,   -1.304273542159965,    -2.7320171864713108,
    -0.15133230156556152,  -5.392945976184154,    -2.217465757625169,
    0.12541113516773927,   -1.5473002945859482,   -4.113357727326983,
    4.887498981656458,     3.04317691111587,      4.49349384915409,
    -3.974856486623069,    -3.2552948432117774,   -3.566752217180045,
    -5.859085564089275,    -6.295046846979351,    1.4406753073543135,
    0.13917081656016314,   0.24792623994027538,   -0.014332730601150348,
    0.09990771887953774,   -0.24493926709906844,  0.4481969515796224,
    11.381544585897148,    13.037508451728236,    29.543802266079183,
    22.461133851452203,    15.459977687140626,    20.6861184133842,
    36.20623441663081,     38.62546945982485,     37.57498153307035,
    -3.1284675231991605,   0.1254133865065879,    -0.4482290729948977,
    0.038421307151468395,  1.7887875363115442,    -0.21554939456117259,
    12.336669941357249,    18.327474269607908,    16.63380706755566,
    17.36834749272055,     22.197880447101834,    23.233888204489475,
    26.968434372528147,    31.077349719757773,    53.95119227841926,
    -1.4436696226929415,   -1.8087070191282155,   1.0781813262615116,
    -0.8475026923459603,   0.057197646260096345,  1.0383477420844958,
    0.11072790085616187,   -0.405450545072277,    2.8877244569995724,
    3.1488456825370843,    6.412263335868295,     3.9521296486666313,
    1.7734469080722108,    3.479072965560227,     1.9465603839923835,
    1.6935645657372096,    -0.1535848364421388,   -0.568264378521074,
    -1.1181816853934603,   -0.8073578850855118,   0.642461149483086,
    4.613941436948071,     -0.6122831575231071,   2.051323062239592,
    1.7836158747514204,    3.128958598168805,     3.1917423583228666,
    1.3501788558317103,    2.608376821323589,     3.070868365410125,
    -4.036726157252666,    -1.1338043021792654,   -0.5016393717766993,
    -1.5917812767145092,   -2.1116365544448987,   -1.1686528913528262,
    -2.762904676365054,    2.2191570883965177,    6.163195693295053,
    6.562442096324314,     6.895634779361155,     7.813444247383543,
    8.769985879213925,     9.123044697681703,     10.370543635155379,
    0.5199456151476447,    -2.24215109897805,     -1.7197781471897304,
    -2.233113814443734,    -0.46797601153579166,  -2.4504194170540465,
    2.660162482931097,     4.332098483367928,     2.364112279092263,
    7.221954130636425,     8.579698000928245,     7.015721273069931,
    7.701317734475693,     10.59476620699736,     10.2329032904714,
    -0.37706993049299625,  -1.7418736042868788,   -0.37878629863873087,
    0.1653320346493494,    -0.9936567142599896,   -0.7670491070831076,
    0.7466218793233269,    1.1186086800904191,    0.7471317631148799,
    0.15380211707235808,   0.16530605145168667,   0.13968569571871076,
    -0.10723713108296282,  -0.024758135369407745, -0.163909901392048,
    0.01873490068243809,   -1.0719269256448065,   0.1390332477695251,
    -1.3072614454832854,   -0.8323402964859872,   -1.0057393884209944,
    2.3409555629997088,    2.004826862113051,     1.1586495203236595,
    0.049559850501644964,  0.15710661328600617,   0.2537545626960282,
    -0.00435100322895032,  0.08687570026512098,   0.1570900002463022,
    -0.23639951371108775,  -0.1970400725317798,   -0.3045097312958692,
    -0.20585465882288054,  -0.08859222602663716,  0.08167635382421351,
    -0.04749338555118063,  -0.19063787599463985,  0.3671384855100783,
    0.8715759918575778,    0.5813478637727224,    0.7843457225870207,
    -0.12287627816127887,  0.13996676105711517,   -0.053732547256770395,
    -0.3891629382974871,   -0.05524335534721879,  -0.2582734609436278,
    -0.16044258309482132,  0.11072808056076384,   0.009580489744134606,
    -0.2457749988667669,   0.15025177689650676,   0.016085958336024032,
    0.6258506149535317,    0.6509767184673183,    0.6053439266655706,
    -0.23792568726168642,  0.09168751096174389,   0.5189242788178648,
    0.9839559816396879,    -1.8553519467235244,   -0.35153498320904836,
    2.216335795984336,     -1.33815155132596,     3.1145361453003177,
    5.288923021681119,     -2.66591283796207,     23.822188160659,
    37.35647880773831,     40.254538366364805,    47.07844847771404,
    -7.47187669075316,     1.6591555725023945,    0.06310018013989292,
    0.5322319194473991,    -0.012660174921816297, -0.5860203521159063,
    -0.4704368424339615,   -0.5959517475382138,   3.161580677991401,
    1.70151830162266,      18.59153984427856,     14.41984697351502,
    30.994496940901143,    28.675590897565474,    34.32315163645719,
    -3.1270068799231994,   -0.10218240017488,     20.51751139569658,
    -2.488512191667191,    -0.6954295029215611,   -1.844228284197026,
    -2.9248431441260196,   -2.8806667987124546,   -1.1645124850369997,
    -0.0778807015499985,   -0.43948633451017116,  -0.9484788631119275,
    -0.034134530216510944, 0.04467460255903529,   -0.36754295356280337,
    -0.30257164355783267,  -0.20798489213470936,  0.04794783836699274,
    -0.4635875055637269,   -1.2656962466454087,   -0.4422619956766753,
    -1.0948234460754596,   -1.6614066904497076,   0.0471878788540583,
    0.4096642650957282,    0.4510193421678865,    0.49017474398067895,
    0.009242937490777283,  -0.14483499669027464,  -0.20481350557917513,
    -0.1801612377038962,   -0.059892605228023255, -0.15309987251387078,
    -0.4549865104464471,   0.059775363925023965,  -0.14383354621548433,
    -0.3454768614084893,   -0.3090737878096128,   -0.28239803980738754,
    -0.41091673314201105,  0.10551953591241961,   0.3020784832063916,
    0.8064422128716665,    0.6727872005531469,    0.802429384635113,
    0.7828973328190801,    0.840898226962087,     0.8785023196571287,
    -0.09823635198009949,  -0.32952642223396456,  0.001705802507955001,
    -0.49942124049624814,  -0.19711494975578542,  -0.027369497222334508,
    0.05002051250327659,   -0.3115036948863887,   -0.13499796828641847,
    0.5154799941380337,    0.6849875182938803,    0.8800709984515938,
    0.5701420859631501,    0.7417465690144799,    0.716286615509517,
    0.009535371737263149,  -0.11134941673882998,  -0.3913150276578658,
    -0.18970277712547703,  -0.1179284194360595,   -0.1406723515337512,
    0.08170795535740305,   0.17949806103030425,   -0.2311319162371071,
    -0.226418883558322,    -0.22660259566427265,  -0.28242421379617927,
    -0.5245272168107921,   -0.2300087279517509,   -0.40208737013475027,
    -0.17585407878149378,  -0.2028222050628393,   -0.03392523538501511,
    0.15707099749999243,   0.024583837697964152,  0.10912533728845028,
    -0.1251964715897191,   -0.16307441483915616,  0.06133530918596123,
    -0.5290425827906543,   -0.44633912893437433,  -0.5531911457545732,
    -0.6100640160267919,   -0.6108222012591294,   -0.407963741416972,
    -0.2425926267056852,   1.24315088091198,      -0.5712264650121535,
    0.7227136016916522,    0.9124952963553752,    -0.3564194409152363,
    24.477648263828286,    20.775955279176625,    17.3461172470945,
    36.813945927252504,    33.73310828270864,     31.803273917958627,
    40.580946805448505,    31.661213155309575,    39.73920465749579,
    0.16859710485677898,   0.6247714425065709,    -0.3321907737839709,
    -0.7811134188759049,   -0.2575574242980313,   -1.3168885133114585,
    20.0964599709446,      14.832569401829117,    13.142912497348098,
    31.766115256748833,    30.9346315367308,      27.884195493888747,
    39.85047649307633,     40.66210079520584,     20.45727877303538,
    -2.662606063516163,    0.7447986745651104,    0.18254774506700622,
    1.8370070032472388,    -0.24676513583899712,  0.14485350038466915,
    3.5104120889628185,    -1.1136284552682254,   9.251517127972607,
    21.738541644943123,    21.738256537007,       21.88868823101582,
    24.55129640880011,     27.313105871748558,    29.31816978780799,
    0.09815270692186143,   -2.0273090644201113,   -1.2205596959624632,
    0.9653994182292015,    -1.3629006993761676,   0.2582097064393612,
    2.5533946956797475,    3.1738029839959094,    1.6513569101530474,
    28.040988482434337,    18.11862512332814,     20.234976548852575,
    32.497829574494276,    26.324605245532197,    17.880466158826177,
    0.06781637606474268,   -0.04643285436890665,  0.31956961854733124,
    0.6485804076257337,    0.34579189942995037,   -0.06505382859525079,
    24.03721433271277,     22.247468859738664,    18.874377784103935,
    32.097198710056084,    33.14219812269419,     34.10786792136773,
    36.23426707292357,     29.597429258392904,    33.0984016679581,
    -0.19798561138440507,  -0.1748031011306755,   -0.2217909217709089,
    -0.3750416535596365,   -0.6710063448884884,   -0.2721297399139279,
    21.135117248431335,    12.263482460700397,    13.322441314996869,
    25.565522394454543,    29.20740811369098,     25.55402833450083,
    31.285967293547948,    39.55146420416397,     30.371454866320438,
    0.8142388725754289,    1.1929258674642718,    0.1729286495867064,
    -1.1739675637337594,   0.3767957716622649,    -0.3193346169312217,
    21.585092985039395,    19.649432799219195,    18.8166410183044,
    15.846362972574724,    13.190492589117312,    13.437003139612282,
    11.236711910769262,    7.3204345581278085,    8.170202801249275,
    -0.926937773823078,    -1.6915411929223396,   0.32879728347631093,
    -1.0108395556412824,   -0.12504570073797328,  -0.1178192292745117,
    16.615622564563537,    15.48697321360894,     21.32241462336362,
    -0.12532956605918252,  11.859931811377711,    10.426579349305424,
    -3.0226563546513394,   -0.7721553865942488,   17.55853669144208,
    2.031911667667527,     3.5925813829458413,    1.103200232920788,
    2.0530673555562124,    0.8910104669200243,    -1.6673711269517333,
    12.212428107844511,    7.570518840365035,     13.401043863665747,
    6.960575420311452,     7.793210739661404,     12.159634644011483,
    20.280104648582103,    20.765480271966496,    25.465463004769536,
    -0.6286452618045857,   0.2583975129459395,    0.4735646110175022,
    -0.2461291775914519,   0.2386036881238315,    -2.0145741498080247,
    12.14909387029681,     11.930587227974229,    10.293756752890916,
    17.63828885949108,     5.120848526629407,     15.251961285314819,
    36.29431039152023,     22.806278478719282,    17.447849659325097,
    -0.20276777051935277,  -1.3309909087986116,   -0.782730449646734,
    -0.27395704938947346,  -0.3331444511036283,   -1.0512201291269732,
    0.8515637669345171,    -1.160422131530644,    -0.4453881333930603,
    0.07047146075614323,   0.20389302435167758,   0.8579547457243222,
    0.49863347850122597,   0.42353657155765667,   0.3343053060463855,
    -0.43475757099931295,  -0.49709569976968193,  -0.5383121071588851,
    -0.9457234254018003,   0.21991093449341284,   -0.0871434261713571,
    -0.24733801027346808,  -0.06001844607507043,  -0.014252937049251211,
    0.6152948099963961,    -0.09631548079720598,  0.1346053392196441,
    0.4942600767973317,    0.047483264287363214,  0.5330989667468291,
    -0.1373183207720196,   -0.7301958546545437,   -0.5698609013753031,
    -0.11197068806396937,  -0.7732723608055522,   -0.3017548057236315,
    5.198617878701372,     6.860852436377891,     3.5770880662834297,
    2.085969903977998,     2.2918457181856073,    2.712852822110572,
    -0.2679297814191413,   -0.6078361614184458,   -0.41825909205714856,
    -2.4562267697477496,   -1.8782350890164456,   -0.773761216271465,
    -1.6278807078313866,   1.065870588638599,     -2.002913147651651,
    2.9113028067296436,    2.0912339016046877,    7.405574727329968,
    4.866556701225143,     2.47374031017736,      1.876661035797345,
    -2.7853269308658506,   -2.162695369561059,    1.529210023432369
};

const float linner_layer1_bias[NETWORKS_LINNER1_SIZE] = {
    3.126721268314084,   -0.030176150458668217, 0.28618923595585183,
    0.16375961899361222, 0.11351134111885466,   -4.180024413197137,
    17.99347619535329,   12.08707961345575,     3.135463808664364,
    -4.214224668548823,  15.065665558494313,    4.114774738788555,
    -1.4592817778006912, 1.2292655416782692,    -0.47297017705910255,
    5.49264821452507,    15.568559906710796,    3.4434995893897082,
    -1.8672406612034023, 10.929414812816033,    -0.08771840586932654,
    0.13678224773463998, 0.6620800956253062,    -0.3673658571393724,
    0.30305141857706225, 7.463332828942716,     -5.851516141073232,
    15.15297467287128,   28.394268108123505,    0.9878000000128696,
    1.8635512014730744,  0.9463436452003546
};

const float
    linner_layer2_weight[NETWORKS_LINNER1_SIZE * NETWORKS_LINNER2_SIZE] = {
        0.46599381112999283,    0.726188010634483,     0.09040103421366423,
        -1.2447623295979708,    -0.8051896299948762,   0.4712283006734343,
        1.033805818515886,      0.2738493139758625,    1.68680493921264,
        0.6022302302318581,     1.2763600810768128,    -0.19935059718386292,
        1.502745755934523,      -1.453627159531377,    0.698119291857358,
        0.9749178350082374,     0.970415407238323,     1.305155676581974,
        -0.8347081759253255,    -0.3036247887855288,   0.07342224339122996,
        -0.6309163343681048,    1.4481154138411592,    -0.6852507466812773,
        0.9595381972429516,     0.7289830941877316,    0.30801983667300115,
        0.006376164575942437,   1.1846298975107854,    0.8426653613160102,
        0.21975764466095546,    0.5805270030169555,    4.1850067482372335,
        -0.6990016935157793,    -5.090917137318523,    2.1644374349877573,
        -4.751391214582182,     -3.373296314825337,    0.28374980846948816,
        -1.073531289494948,     2.143445724090584,     -4.1044487000087395,
        1.5144641119901872,     -5.847023162324953,    5.293598554818004,
        -2.2632903608951755,    0.14650279115314369,   11.125211220710698,
        -1.1909571620402672,    0.10186661285038665,   -9.403945488150502,
        -3.252207811767073,     3.89441376706267,      -6.085498737613452,
        0.7527346824517039,     -4.735284370916497,    0.338963252587324,
        -0.25189363649203117,   2.0708832748882005,    -1.9398611271192365,
        4.032648179559173,      -0.13933627836514043,  -2.3579132571077177,
        6.494634996120651,      -2.1300578239086647,   0.29886588596621677,
        -5.647829913289531,     2.548841870144967,     -7.1332751106903025,
        -1.64127731811139,      -2.0827051869934747,   -6.095810850393691,
        2.291306820074818,      -4.052248329344387,    -3.947332441249421,
        -5.0803341563939854,    2.4980858396002064,    -10.142281942543065,
        3.438660070228272,      3.254513937672552,     -3.030397354053793,
        1.628604810767199,      -5.440860711786388,    -5.732584011151757,
        2.2350890444975504,     -6.773991010336276,    0.8027771465596518,
        -2.9779756468882397,    0.4042599693343939,    1.6923584335265827,
        -1.781735232767376,     -2.129664372244144,    6.032001624710546,
        -0.8370090460630725,    -3.253415598318911,    -1.1945597999052378,
        0.4544305536653745,     0.7021614306795104,    0.06143353238736749,
        -1.009171052834018,     -0.8635549231281684,   0.5221225024708648,
        1.026697202106496,      0.2924218775676141,    1.63485980666359,
        0.6191541015547191,     1.3670899006278978,    -0.24981511986575983,
        1.515928897531765,      -1.4637444094655987,   0.7096150904410602,
        0.956762653851914,      0.9880615519779152,    1.3056711107520045,
        -0.8124856606276811,    -0.1962210366881841,   -0.03165328852340953,
        -0.6452648988244062,    1.505256166632752,     -0.7153241178241577,
        0.8697323359201157,     0.7235620223355912,    0.3240540443292385,
        0.007141115043775859,   1.1454569614394898,    0.7917464543265681,
        0.21608563601032504,    0.5307046919191113,    1.1038034549563402,
        0.8932549350986151,     0.8376352083018619,    -1.460861931659628,
        -0.8429025908431981,    0.35638962285334524,   1.1136502833991473,
        -0.012005923333640148,  0.7714268049487036,    0.6623272059491571,
        0.8500507879007572,     -0.07792538046712233,  0.7429119103055005,
        -1.078134422858026,     0.2571573377212459,    1.3255695479364837,
        1.681162799155192,      0.6326914742430682,    -0.05488065896968227,
        -0.2081976358057939,    -0.2583326093830974,   0.31421304636470143,
        0.7047783817485591,     -0.8033349501292699,   0.8676798165142546,
        0.8693614417883048,     0.2437197796558349,    0.9313595119890672,
        1.4584162014561237,     0.8949303702933794,    0.2489768133370156,
        0.17614657965739497,    1.6195301093281271,    -0.014545317253460357,
        6.116937721038079,      0.7283963869995923,    -2.8580005695841666,
        0.3368990970257605,     9.127361911454306,     -2.3548260967963417,
        -2.1018947468248577,    -3.397163390727154,    -0.7267788556079406,
        7.374912036313759,      0.8372636564557163,    -2.3610507918999875,
        -1.9418988105343673,    -1.9211926140689997,   7.2866803455009626,
        2.874400175571999,      -1.0205350918162845,   0.03948233191308338,
        1.5335767946289482,     -2.807732913287611,    -1.3071724553951487,
        -2.288565302762212,     0.4677962506037957,    1.2141382422629103,
        -3.861493623120063,     10.638719675314103,    9.547517644166478,
        -7.193684146613537,     -0.4789744469430843,   5.761845324435872,
        1.0747914154070506,     0.8928013462819386,    0.8504180293759144,
        -1.2328775186605752,    -0.80374990565195,     0.3447547409205047,
        1.1111768624434903,     -0.034249328166794664, 0.7097127501296715,
        0.6753109715447075,     0.8646814947729722,    -0.038041685222969294,
        0.7792196435659577,     -0.9805943236105789,   0.26575029729622945,
        1.3997361672276114,     1.7099220385777936,    0.5944642307479178,
        -0.1290032980581585,    -0.1316217241340936,   -0.1281156834212321,
        0.31671363777906875,    0.7164320808289624,    -0.850670642436158,
        0.8669583675590992,     0.908070959882253,     0.2166244960064816,
        0.9912786218842105,     1.5734102514384853,    0.9294942806421855,
        0.10318042786283066,    0.1578048620000534,    1.109484025265116,
        0.8985134707180582,     0.8167044155736721,    -1.4569594593000899,
        -0.8416143824032226,    0.343100077966461,     1.0904900606860053,
        -0.0025903444807065515, 0.7214028544416825,    0.6608625063533162,
        0.8445240450066641,     -0.054936398848457156, 0.7290381411885412,
        -0.9924731889704184,    0.24353933073793932,   1.2987349476087693,
        1.6788720587227162,     0.5909217427223433,    -0.05458306188176707,
        -0.20445918727380688,   -0.18174903731509676,  0.28117628030959496,
        0.7197401329846739,     -0.7965230861362514,   0.8315023106529392,
        0.8338090687839442,     0.22078074037296694,   0.902684135081137,
        1.4439173809281685,     0.8831051313814758,    0.26093592481864725,
        0.14292623684053302,    -0.9308283704362608,   -1.7024798251126392,
        5.474493490180611,      1.2684821616271955,    -0.3897399616554474,
        1.6098063356133818,     -4.405756061731266,    0.6710794088569695,
        2.5497186451368976,     4.921078283331115,     2.7180811695050875,
        2.538112140408259,      2.7627415394633483,    -2.196838811289607,
        -3.231149419377275,     2.7455471171151435,    -4.048670295915789,
        1.0284281566634155,     -0.8452603360321855,   1.0694830443277448,
        0.9226634602733124,     -4.927453008519793,    0.6690814231131623,
        -1.6958939127098438,    0.32026115894387164,   5.0582032869764655,
        2.496427105565526,      7.942251374582237,     -1.911946455463211,
        0.5416073372637233,     -1.2145442497183363,   -1.6198467704980857,
        0.42127482551667716,    0.6424062915188091,    1.1138635973002808,
        -1.2484132324851238,    -1.0936222255694168,   0.5136800235003589,
        0.8038215779236727,     -0.37154820434382746,  1.044616243846694,
        0.9213216668347223,     0.7033839105500116,    0.040102775287336204,
        0.9836892856952327,     -1.075265822221159,    -0.08248638204296287,
        0.5335517752587348,     0.6051329098470116,    0.7574775543769326,
        0.13207659274468644,    -0.14466977031139777,  -0.3369188472612031,
        0.3833333335056324,     0.6378751447391018,    -0.755144989024527,
        0.6604608793272094,     0.888069922056879,     0.22353841538624847,
        1.0321501698684536,     0.5422190847948047,    1.0292933160390902,
        0.00804919479400498,    0.11988661107893128,   0.3785797875025279,
        0.6970115687163088,     1.14213215734108,      -1.3787371013520962,
        -1.0834410890082637,    0.489094675826457,     0.7911352314533683,
        -0.3501473626312055,    1.0367411924907606,    0.932543529286073,
        0.6835446579914392,     0.03713284973658641,   0.9710975896747818,
        -1.0533806578679226,    -0.0832573791542807,   0.519556976785193,
        0.6006593962001782,     0.7263042632523488,    0.18248080481977486,
        -0.08636557848353442,   -0.36225475672611435,  0.3479801103753833,
        0.637814256033251,      -0.7568339733282354,   0.6789166007411964,
        0.8285064211910869,     0.1883389716666248,    0.9737475944153425,
        0.54851570386092,       1.013669700824687,     0.012928432822767318,
        0.11359338904356983,    2.6530471374971185,    -6.727847422231166,
        0.7050705258212248,     -0.2980501499175169,   -1.565779781619038,
        1.4802358677764036,     2.5311416848191346,    -1.4549446492210303,
        3.071905193750073,      -0.6494671424563389,   -0.9264309396965393,
        1.0821472025998757,     0.6253814548807947,    -0.14120792902200976,
        -0.4764021980990569,    0.5699445164307998,    -0.4306021965613823,
        1.8013528723999543,     -2.1056618798635873,   3.6421182275192563,
        -0.17112749967865487,   3.4504716338746215,    0.10063235400430585,
        -0.46901045386809254,   0.09276818277197965,   2.1902655541044393,
        -3.3704295825547868,    0.4135150493232152,    1.44261889677341,
        1.50467437356827,       1.5343575196252546,    1.7010420091918472,
        -0.07542494907866933,   0.6764113777733496,    0.34911758885956445,
        -0.5391256414603648,    -0.3588241452610996,   0.8852743389756156,
        1.1967262271808325,     0.16292353749503033,   0.802452654372265,
        0.7504869127200391,     0.45439600201843144,   -0.2604513291050071,
        0.773013372095179,      -0.6636132704014028,   0.6974242980206445,
        0.5674322758679224,     1.0704249708330968,    0.6180403314393383,
        -0.09976909440252574,   -0.08201253889269736,  0.24922464121746327,
        0.6437888377493886,     0.33866799312255674,   -0.3981863342264734,
        0.2488052696599173,     0.8444232918103642,    0.45643526860572015,
        0.00724270777512222,    1.1255030705563402,    0.7421649669949849,
        -0.32616665120793387,   0.30644146300738834,   1.7277032658938307,
        0.4745633277144661,     -2.8018458815418814,   -0.06917225168800414,
        -1.4198549666725522,    7.586333773042468,     8.71271377348703,
        -0.49285363315433406,   1.1800356995938062,    3.4159100838678125,
        0.5198238685329222,     -5.747681162981089,    1.665711462364364,
        0.19937195013212855,    -3.894000598888629,    -1.0569116371102425,
        -1.500340711685784,     7.542978403371751,     3.22782458422288,
        0.3389570933635748,     -0.14978118821717698,  1.2871270771660062,
        2.628500187808905,      -0.446790101189755,    0.5433501980410008,
        -0.5981235880445809,    2.2821147990898067,    -5.820629449971511,
        -4.132999935008875,     -1.647533963325344,    0.20060975238936535,
        1.3053927277056192,     1.5176333964371163,    2.537962666813731,
        3.0018388989249583,     -0.3938780070084113,   -0.3769687815435372,
        -3.9037299505984824,    -2.1053904693449343,   -0.3148425617816861,
        0.16891871120247415,    1.5953916319194898,    -1.0979265564187715,
        -5.273198486141587,     0.34203882913810324,   -2.0850973931132843,
        2.6085551677917946,     -1.1622447064260675,   11.25940974829805,
        1.6581644053614604,     2.6040374259637806,    -0.7588776160524543,
        -0.27267200692631616,   6.0372022066551265,    1.813866879606222,
        -0.26048398418937657,   0.5181046507135201,    -2.7300686812527877,
        0.048464267584095576,   -8.348717552442332,    0.15037665236001976,
        -1.1092941655886555,    -1.4653552986473803,   -1.2244324872373915,
        -1.8571958723598467,    4.484740516175095,     -0.9574662000488642,
        -0.8566727378581838,    -0.3518416378929379,   -2.0375898446444514,
        3.645213100688896,      1.4783782256987938,    -3.537740318128035,
        3.037223761762743,      1.842218663037657,     4.737552041959761,
        1.2017211659872673,     1.4925603541114378,    4.361847008395805,
        1.5017557746152663,     2.9367925974848528,    -0.7687448862677807,
        1.666199159126934,      1.6592007654093466,    -0.04870422851990928,
        -1.7578254754650844,    1.4532144144466377,    -0.312891827608926,
        0.6937363911617583,     4.136652939134806,     -0.453327961664663,
        -9.90560832896629,      6.001381898781352,     4.591451756335193,
        0.48406965425897314,    2.011825009009613,     0.04394987838185283,
        1.8534130709652066,     0.29835871418803084,   1.0368785743598203,
        -1.7656020859813841,    -0.7454399566869363,   1.3235446212021185,
        0.4380109908980935,     0.17509702734944516,   -4.124016692113685,
        4.165661984492062,      1.7852941648586615,    2.615673894459047,
        -2.4002443035325673,    -5.308095103518673,    2.14633386390309,
        -0.42303707139971286,   7.879064905315809,     -2.4135727439777286,
        2.516668721329898,      2.195468057117935,     -0.5229822985537474,
        1.3294853489820262,     -2.7925261080174986,   0.17648933624230614,
        0.7172312504755474,     0.7044482107287375,    2.5283214422282243,
        -2.4124772024346934,    8.413600945801676,     -1.1507141329406567,
        2.5280552546675064,     0.45453539388038366,   1.3866952214624897,
        0.4250526415124718,     -1.0695903038559507,   -0.6837280681301883,
        0.9697825152257655,     1.2991923848669436,    -0.2823966018635905,
        1.3376971670392577,     1.274596439654484,     0.811695556633305,
        0.19978002265739697,    1.1348519235967955,    -0.7375084789891563,
        0.7681077762677605,     0.5449748668932265,    1.067495587721447,
        1.0275882330112838,     -0.0630857175527628,   0.20534369184924314,
        -0.05285655418603617,   0.9213434119092935,    1.0409858153949505,
        -0.750218948975614,     0.7494139538875887,    0.28247542915473384,
        0.5470135553765075,     0.5901389016728077,    0.8778916504684645,
        1.909131969373099,      0.13991579795880696,   0.38169209983586716,
        0.4110319909734275,     1.39712864959679,      0.47597154278611564,
        -0.4418459887707282,    -0.766106986704187,    1.0095075538431524,
        1.2163768007375897,     -0.3520311117322216,   1.336119916674537,
        1.2866541562098215,     0.7432485954807123,    0.16994450970637248,
        0.9862647481185643,     -0.7882958697183664,   0.7717156050939331,
        0.5114140889773794,     1.1212206703691747,    1.0367128939516999,
        -0.12993188381365237,   0.20632810027403545,   -0.06746664692888396,
        0.9194441760210654,     0.9742931849926998,    -0.72868601107818,
        0.6729640786705599,     0.17791837499660534,   0.5649255531357117,
        0.6225461464445352,     1.0555062023197974,    1.9394553356392124,
        0.06968682345273208,    0.3696799232384257,    0.8875233872859046,
        1.86006123127041,       -3.8798926660506154,   3.327140467663409,
        -2.3082036504582844,    -0.3167903044119424,   3.8543056963660587,
        0.5228750615310577,     3.2494148446521764,    -0.907694862847288,
        5.364246341368876,      -1.6953799326406243,   4.298777772734627,
        -6.491042121498634,     -6.0608325876706575,   4.24486041360242,
        0.5086044781975554,     12.079464340437067,    -2.1468699753028573,
        3.901005818622626,      3.164543907556387,     5.0666893347331206,
        0.7416780542176233,     -3.9588848837401813,   1.9348027944258417,
        -5.005931292632208,     3.031902602359185,     -2.9563711591583743,
        -0.2722599810044167,    11.18989381549058,     -4.071603328910448,
        2.6727663226583087,     0.36673707153597895,   0.15935442040567505,
        0.3282333212042119,     -0.9298187418707826,   -0.40538573979174725,
        0.8944266727930109,     0.4670918777820881,    -0.11904600286874432,
        0.5975133366547396,     0.7392700257123596,    0.8786691818716944,
        0.5745155620069093,     0.6153576813314534,    -0.7328015970775841,
        1.129068739021965,      0.08454415272455212,   0.6286994355689365,
        0.583828633771285,      -0.19270171524837745,  0.14032580656578764,
        0.3702013295303196,     0.720705232524154,     0.42397221844430627,
        -0.3823589971673492,    0.6804123554515484,    1.2869733508647097,
        0.364728993751076,      0.2463072221741831,    1.3166245791698328,
        1.043211848104834,      0.09188703833928366,   0.756684462889936,
        2.6190509894789344,     -5.812309735878332,    3.2356391193827068,
        0.9011728430750898,     0.2573628083017772,    6.015411358043409,
        3.4808619599232338,     5.137592869074663,     2.0151700914296993,
        1.6926348032673806,     4.838469157838851,     3.275216935774424,
        1.9265174023880438,     2.841541459309958,     6.51049956947889,
        -0.12278993176752535,   0.7270450464367266,    -4.856604648756527,
        -4.010246608540269,     3.76652947649092,      0.6006580820946161,
        2.9584111024728155,     -0.643149560178215,    -0.8429135116507734,
        0.7948342017147154,     5.100881108649997,     -1.592257607737579,
        3.0158219349445545,     -3.507694086554769,    5.195463355565851,
        -0.0008801979884407913, 1.2718020199225293,    0.3502850530737433,
        0.14054693613990663,    0.30280227870918713,   -0.9440036670107171,
        -0.3766291705026162,    0.9395426028090434,    0.441767718237099,
        -0.11303417577886098,   0.613855151860223,     0.6758788319701723,
        0.8843209764506177,     0.6365255771297407,    0.6381963050159151,
        -0.7344605183870901,    1.091949133964098,     0.05486340162433981,
        0.6561953926626952,     0.6123724661006362,    -0.178228270936427,
        0.09637045359163011,    0.36403429271397025,   0.6012184928055198,
        0.4696998487408988,     -0.4778418429381154,   0.6796499089434248,
        1.291977829505936,      0.38177057680023285,   0.29943980060328595,
        1.3071630803573386,     1.0403963588365535,    0.1116405310060571,
        0.7218201484850426,     -3.8425597319568183,   0.6157842613348444,
        -4.928618460979178,     -0.8218670292673619,   1.4838268493491005,
        4.615450186717116,      -1.935653547460575,    0.6468417718895826,
        2.7511003494446733,     3.461461789183675,     3.379218664835104,
        0.8578549040082796,     -0.08402492569879486,  -0.6998228570207822,
        5.0733382635900695,     0.27712094525580294,   -2.041221933817017,
        -5.730889195878669,     -0.5006308459698995,   0.6499049029555684,
        -1.2524707002236337,    7.564728509603758,     -0.36930658464352717,
        0.7589633807028634,     0.15689473257496542,   0.7226594389129141,
        -0.42804228649504783,   3.8426674162284287,    3.819589913523868,
        1.537313954211415,      0.061031745648076376,  -0.8625858970160958
    };
const float linner_layer2_bias[NETWORKS_LINNER2_SIZE] = {
    -2.47492603857373,   -6.749053706893601,  -4.238983078204463,
    -2.4302980216526118, -2.364214822978202,  -1.331756706421174,
    -2.4288435641108284, -2.3884476454930996, -1.6308928620949599,
    -2.2544073362306185, -2.1752405308959193, -3.1388041373217366,
    -1.5044671812283792, -1.3100587122915353, -0.4861557760958073,
    -1.4362800961268907, -5.256052246447474,  -2.38963306916847,
    -2.1449229644819914, -5.187916023829814,  -1.6164937057227928,
    0.46785765329525786, -1.627546931526877,  1.4716725388323288
};

const float batch_normal_weight[NETWORKS_BATCHNORMAL1D_SIZE] = {
    4.1409, 3.9793, 6.7132,  6.3897, 3.3582, 6.1925,  9.4022, 4.0726,
    3.4271, 8.5347, 2.9962,  5.2588, 2.1316, 0.8751,  8.3284, 0.4437,
    8.2700, 6.3592, -0.6558, 2.3517, 1.3832, 10.3203, 7.0237, 1.8826,
    1.4922, 7.6236, 7.8416,  6.9612, 8.7300, 17.7785, 3.1899, 2.9794
};
const float batch_normal_bias[NETWORKS_BATCHNORMAL1D_SIZE] = {
    -0.6822, 2.3519,  0.6459, -0.2304, 1.3256,  1.3849, -0.9953, 1.1506,
    0.4308,  0.7978,  1.0627, 1.7650,  -0.0499, 0.6096, 0.8985,  0.1148,
    -0.5946, 0.6498,  0.0310, 0.4694,  -0.4588, 1.7881, 0.5306,  0.3917,
    0.0027,  -0.6870, 1.7942, 1.6242,  -0.9404, 1.7163, 0.0748,  -0.4968
};
const float batch_normal_running_mean[NETWORKS_BATCHNORMAL1D_SIZE] = {
    FLT_MIN,
    6210.444954292855,
    206508.75781464158,
    0.03528871173065771,
    FLT_MIN,
    371417.030711922,
    582724.2854326313,
    7.2460104417197035,
    26.783799364272095,
    180948.82703214805,
    32.34233011534481,
    895742.0954127107,
    FLT_MIN,
    885.359881791216,
    616722.238558261,
    1506.4684256137616,
    77003.72681670953,
    3099322.0205624867,
    5.052481065644358,
    2.607770897356141,
    FLT_MIN,
    2576802.218328275,
    FLT_MIN,
    FLT_MIN,
    FLT_MIN,
    342297.7120508508,
    108363.0680947516,
    276723.279505874,
    216336.915493771,
    5635237.071581095,
    FLT_MIN,
    18.560829184005968
};
const float batch_normal_running_var[NETWORKS_BATCHNORMAL1D_SIZE] = {
    FLT_MIN,
    12103385541.984762,
    51707935527.91116,
    1223.4547961337837,
    FLT_MIN,
    541039144409.66895,
    1291307784947.4827,
    1141.2347632397457,
    13178.441565919551,
    45648893998.58545,
    15845.058602244351,
    2106041985582.3394,
    FLT_MIN,
    349831171.7461941,
    2164407632738.7273,
    743149714.0491723,
    26089319951.54715,
    45676686733345.89,
    15624.661921218336,
    153.07346873266962,
    FLT_MIN,
    14146595741695.098,
    FLT_MIN,
    FLT_MIN,
    FLT_MIN,
    321239721740.20483,
    106358491810.26958,
    163543047479.4659,
    186767599513.6804,
    35847043925389.44,
    FLT_MIN,
    13091.972944081457
};
// const float hidden_layer_weight[NETWORKS_HIDDEN_SIZE * NETWORKS_OUTPUT_SIZE]
// = {-0.4589923620f, 2.3280203342f, -4.1144347191f, -1.1487400532f,
//                                                                                 -0.4644607008f, 0.5328536034f, -0.9638527632f, 0.7887286544f,
//                                                                                 2.4604980946f, 3.2788965702f, 1.0151129961f, -2.6160552502f,
//                                                                                 4.1275353432f, 1.6911562681f, 0.7115666866f, -0.3596055508f,
//                                                                                 1.3174898624f, -0.9191195965f, -2.2845132351f, -3.5295078754f};

const float hidden_layer_bias[NETWORKS_OUTPUT_SIZE] = { 1.4795401096f,
                                                        -1.3724881411f };

static int linear_calculation(NetwoksLayer *layer, LayerData *input_data,
                              LayerData *output_data)
{
    uint16_t i = 0, j = 0;
    float tmp_sum = 0.0f;

    if (!layer || !input_data || !output_data) {
        return NET_ERR_GENERIC;
    }

    if (input_data->size != layer->row_num ||
        output_data->size != layer->column_num) {
        return NET_ERR_GENERIC;
    }

    for (i = 0; i < output_data->size; i++) {
        tmp_sum = 0.0f;
        for (j = 0; j < layer->row_num; j++) {
            tmp_sum +=
                input_data->data[j] * layer->weight[i * layer->row_num + j];
        }
        tmp_sum += layer->bias[i];
        output_data->data[i] = tmp_sum;
    }

    return NET_NORMAL;
}

static int relu(LayerData *input_data)
{
    uint16_t i = 0;
    if (!input_data) {
        return NET_ERR_GENERIC;
    }
    for (i = 0; i < input_data->size; i++) {
        if (input_data->data[i] < 0.0f) {
            input_data->data[i] = 0.0f;
        }
    }
    return NET_NORMAL;
}

static int batch_normal1d(LayerData *input_data)
{
    uint16_t i = 0;
    for (i = 0; i < input_data->size; ++i) {
        input_data->data[i] =
            ((input_data->data[i] - batch_normal_running_mean[i]) /
             sqrt(batch_normal_running_var[i] + EPS)) *
                batch_normal_weight[i] +
            batch_normal_bias[i];
    }
    return NET_NORMAL;
}

static int max_pool(LayerData *input_data, LayerData *output_data)
{
    uint16_t i = 0;
    float max  = input_data->data[0];
    for (i = 1; i < input_data->size; ++i) {
        max = max > input_data->data[i] ? max : input_data->data[i];
        if ((i + 1) % NETWORKS_POOL_SIZE == 0) {
            output_data->data[i / NETWORKS_POOL_SIZE] = max;
            max                                       = -10000;
        }
    }
    return NET_NORMAL;
}

int networks_init(void)
{
    int ret;
    memset(&bp_networks, 0, sizeof(BpNetworks));

    bp_networks.linner_layer1.row_num    = NETWORKS_INPUT_SIZE;
    bp_networks.linner_layer1.column_num = NETWORKS_LINNER1_SIZE;
    bp_networks.linner_layer1.weight     = linner_layer1_weight;
    bp_networks.linner_layer1.bias       = linner_layer1_bias;

    bp_networks.linner_layer2.row_num    = NETWORKS_LINNER1_SIZE;
    bp_networks.linner_layer2.column_num = NETWORKS_LINNER2_SIZE;
    bp_networks.linner_layer2.weight     = linner_layer2_weight;
    bp_networks.linner_layer2.bias       = linner_layer2_bias;

    return NET_NORMAL;
}

static ClassResult result_classification(LayerData *hidden_layer_output)
{
    uint16_t i = 0, j = 0;
    for (i = 0; i < hidden_layer_output->size; i++) {
        if (hidden_layer_output->data[i] > hidden_layer_output->data[j]) {
            j = i;
        }
    }
    return (ClassResult)j;
}

void dump_layer(LayerData *input_data)
{
    for (int i = 0; i < input_data->size; ++i) {
        printf("%f ", input_data->data[i]);
    }
    printf("\n\n");
}

int foward_process(LayerData *input_data, int *class)
{
    float linner_layer1_output_data[NETWORKS_LINNER1_SIZE] = { 0.0f };
    float linner_layer2_output_data[NETWORKS_LINNER2_SIZE] = { 0.0f };
    LayerData linner_layer1_output;
    LayerData linner_layer2_output;

    linner_layer1_output.size = NETWORKS_LINNER1_SIZE;
    linner_layer1_output.data = linner_layer1_output_data;

    linner_layer2_output.size = NETWORKS_LINNER2_SIZE;
    linner_layer2_output.data = linner_layer2_output_data;

    float hidden_layer_output_data[NETWORKS_OUTPUT_SIZE] = { 0.0f };

    LayerData hidden_layer_output;
    hidden_layer_output.size = NETWORKS_OUTPUT_SIZE;
    hidden_layer_output.data = hidden_layer_output_data;

    int ret;

    ret = linear_calculation(&bp_networks.linner_layer1, input_data,
                             &linner_layer1_output);
    dump_layer(&linner_layer1_output);
    if (ret != NET_NORMAL) {
        printf("linnear1 wrong!\n");
        return ret;
    }
    ret = relu(&linner_layer1_output);
    dump_layer(&linner_layer1_output);
    if (ret != NET_NORMAL) {
        printf("relu wrong!\n");
        return ret;
    }
    ret = batch_normal1d(&linner_layer1_output);
    dump_layer(&linner_layer1_output);
    if (ret != NET_NORMAL) {
        printf("batch_normal1d wrong!\n");
        return ret;
    }
    ret = linear_calculation(&bp_networks.linner_layer2, &linner_layer1_output,
                             &linner_layer2_output);
    dump_layer(&linner_layer2_output);
    if (ret != NET_NORMAL) {
        printf("linnear2 wrong!\n");
        return ret;
    }
    ret = max_pool(&linner_layer2_output, &hidden_layer_output);
    dump_layer(&hidden_layer_output);
    // dump_layer(&hidden_layer_output);
    if (ret != NET_NORMAL) {
        printf("max_pool wrong!\n");
        return ret;
    }
    *class = result_classification(&hidden_layer_output);
    printf("class:%d\n", *class);
    return ret;
}